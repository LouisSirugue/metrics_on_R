---
title: "Causality and randomness"
subtitle: "Lecture 9"
author: "<br>Louis SIRUGUE"
date: "`r format(Sys.time(), '%m/%Y')`"
output:
  xaringan::moon_reader: 
    css: 
        - xaringan-themer.css
        - theme.css
    includes:
      in_header: header.html
    lib_dir: libs
    nature:
      ratio: '16:9'
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include = FALSE}
source(paste0(getwd(), "/../source/style.R"))
stargazer <- stargazer::stargazer
theme_minimal <- theme_Rcourse
options(htmltools.dir.version = F)
knitr::opts_chunk$set(echo = T, message = F, warning = F, fig.align = "center", dpi = 300, out.width = "100%")
set.seed(1)
```

<style> .left-column {width: 65%;} .right-column {width: 35%;} </style>

### Last time we saw

--


#### 1) An OLS regression with a binary dependant variable is called a *linear probability model*

$$1\{y_i = \text{Accepted}\} = \hat{\alpha} + \hat{\beta} \times \text{Grade}_i + \hat{\varepsilon_i}$$

<p style = "margin-bottom:1cm;">

.left-column[

```{r, echo = F, fig.width = 7, fig.height = 4, out.width = "85%"}
data_bin <- tibble(x = rnorm(1000, 15, 1), 
                   noisy_x = x + runif(1000, -1, 1),
                   y = ifelse(noisy_x > mean(x), 1, 0))

ggplot(data_bin, aes(x = x, y = y)) +
  geom_point(alpha = .1, color = "#014D64") + xlab("Grade") +
  geom_smooth(method = "lm", se = F, color = "#014D64") +
  scale_y_continuous(name = "", limits = c(-.5, 1.5), breaks = 0:1)
```

]

.right-column[

<p style = "margin-bottom:1cm;">

 * $\hat{\beta}$ indicates by how much the probability that $y$ equals 1 would increase on expectation for a 1 point increase in $x$

<p style = "margin-bottom:1cm;">

 * But linear probability models can lead to probabilities that are lower than 0 and greater than 1
 
]

---

### Last time we saw

#### 2) An OLS regression with a binary independent variable:

$$\text{Height}_i = \hat{\alpha} + \hat{\beta} \times 1\{x_i = \text{Male}\} + \hat{\varepsilon_i}$$

.left-column[

```{r, echo = F, fig.width = 6, fig.height = 4, out.width = "85%"}
data_binx <- tibble(x = rep(c(0, 1), each = 500), 
                    y = c(rnorm(500, 165, 10), rnorm(500, 175, 10)))

ggplot(data_binx, aes(x = as.factor(x), y = y)) +
  ylab("Height") +
  scale_x_discrete(name = "1{Sex[i] = Male}", labels = 0:1) +
  geom_point(data = data_binx %>% mutate(x =x +1), aes(x = x, y = y), alpha = .1, color = "#014D64") +
  geom_boxplot(alpha = .1, width = .1, color = "#014D64") + 
  geom_smooth(data = data_binx %>% mutate(x =x +1), aes(x = x, y = y), method = "lm", se = F, color = "#014D64")
```

]

.right-column[

<p style = "margin-bottom:2cm;">

 * $\hat{\alpha}$ indicates the average value of $y$ when $x$ is equal to 0, i.e., for the reference category

<p style = "margin-bottom:1cm;">

 * $\hat{\beta}$ indicates the difference between the average value of $y$ for the two groups
 
]

---

### Last time we saw

#### 3) An OLS regression with an independant variable with more than 2 categories

$$\text{Earnings}_i = \hat{\alpha} + \hat{\beta_1} 1\{\text{Race}_i = \text{Black}\} + \hat{\beta_2} 1\{\text{Race}_i = \text{Asian}\} + \hat{\beta_3} 1\{\text{Race}_i = \text{Other}\} + \hat{\varepsilon_i}$$

<p style = "margin-bottom:1.25cm;"></p>

  * It should be specified as a sum of binary variables, omitting the category we want as a reference

<p style = "margin-bottom:1cm;"></p>

```{r, echo = F}
asec_2020 <- read.csv("asec_2020.csv")
```

```{r}
summary(lm(Earnings ~ relevel(as.factor(Race), "White"), asec_2020))$coefficients[, c(1, 2, 4)]
```

<p style = "margin-bottom:1cm;"></p>

<ul><ul>
<li>\(\hat{\alpha}\) is the average earnings for the reference category </li>
<li>Coefficients are <i>relative</i> to the reference category</li>
</ul></ul>

---

### Last time we saw

#### 4) Interactions allow to estimate how the coefficient of a given variable varies depending on the value of a third variable

$$\text{Earnings}_i = \hat{\alpha} + \hat{\beta_1}\text{Hours}_i  + \hat{\beta_2}1\{\text{Sex}_i = \text{Male}\} + \hat{\beta_3}\text{Hours}_i \times 1\{\text{Sex}_i = \text{Male}\} + \hat{\varepsilon_i}$$

--

<p style = "margin-bottom:1.75cm;"></p>

<ul>
  <li><b>It captures the difference between males and females in their expected returns to working an additional hour 
  per week</b> </li>
  <ul>
    <li>With \(\hat{\beta_3} > 0\): working an additional hour matters more if you are a male</li>
  </ul>
</ul>

<p style = "margin-bottom:.75cm;"></p>

<ul>
  <li><b>Or equivalently, by how much the effect of being a male varies for an additional hour of work per week</b> </li>
  <ul>
    <li>With \(\hat{\beta_3} > 0\): being a male matters more if you work an additional hour</li>
  </ul>
</ul>

--

<p style = "margin-bottom:.75cm;"></p>

<ul>
  <li>Note that the expected returns to working an additional hour per week is:</li>
  <ul>
    <li>\(\hat{\beta_1}\) for females</li>
    <li>\(\hat{\beta_1} + \hat{\beta_3}\) for males</li>
  </ul>
</ul>

---

### Last time we saw

#### 5) Non-linearities

.pull-left[

 * Log vs. level
 
 <p style = "margin-bottom:1.5cm;"></p>

```{r, echo = F}
kable(tibble(` ` = c("x", "log(x)"),
             y = c("\\(\\hat{\\beta}\\) is the unit increase in \\(y\\) due\n to a 1 unit increase in \\(x\\)",
                   "\\(\\hat{\\beta}\\div 100\\) is the unit increase in \\(y\\) due\n to a 1% increase in \\(x\\)"),
             `log(y)` = c("\\(\\hat{\\beta}\\times 100\\) is the % increase in \\(y\\) due\n to a 1 unit increase in \\(x\\)",
                   "\\(\\hat{\\beta}\\) is the % increase in \\(y\\) due\n to a 1% increase in \\(x\\)")),
      caption = "Interpretation of the regression coefficient", align = "ccc") %>%
  column_spec(1, bold = T) %>%
  column_spec(c(2, 3), width = "10em")
```

]

--

.pull-right[

 * Polynomials
 
$$\text{Wage}_i = -2644 +  192 \times \text{Age}_i -2 \times\text{Age}_i^2 + \hat{\varepsilon}_i$$

 <p style = "margin-bottom:.75cm;"></p>
 
```{r, echo = F, fig.width = 6, fig.height = 4, out.width = "100%"}
quadratic <- tibble(Age = runif(1000, 24, 60),
                    Wage = -2800 + (200 * Age) - (2*Age*Age) + rnorm(1000, 0, 200))

ggplot(quadratic, aes(x = Age, y = Wage)) +
  geom_point(alpha = .5, color = "#014D64") +
  geom_smooth(method = 'lm', formula = y ~ poly(x, 2), se = F, color = "#014D64")
```

]

---

### Today: Causality and randomness

<p style = "margin-bottom:1.75cm;">

#### 1. Causality
<p style = "margin-bottom:-.5cm;">
 * 1.1. Omitted variable bias
 * 1.2. Selection bias and counterfactual

#### 2. Randomness
<p style = "margin-bottom:-.5cm;">
 * 2.1. Data Generating Process & Random variables
 * 2.2. Theoretical vs. empirical moments
 * 2.3. $\beta$ vs. $\hat{\beta}$

#### 3. Causality from randomness
<p style = "margin-bottom:-.5cm;">
 * 3.1. Randomized Controlled Trials
 * 3.2. Types of randomization
 * 3.3. Multiple testing

#### 4. Wrap up!

---

### Today: Causality and randomness

<p style = "margin-bottom:1.75cm;">

#### 1. Causality
<p style = "margin-bottom:-.5cm;">
 * 1.1. Omitted variable bias
 * 1.2. Selection bias and counterfactual

---

### 1. Causality

#### 1.1. Omitted variable bias

* Consider the following regression
  
$$\text{Earnings}_i = \hat{\alpha} + \hat{\beta}1\{\text{Sex}_i = \text{Male}\} + \hat{\varepsilon_i}$$
    
--
    
```{r}
summary(lm(Earnings ~ Sex, asec_2020))$coefficients
```
  
--
    
<p style = "margin-bottom:1.25cm;"></p>
  
  * Taking $\hat{\beta}$ at face value, the *'expected returns'* to being a male amount to $21,612.33 in annual earnings

--

<ul>
  <li>What do you think about this estimation? </li>
  <ul>
    <li>Can we say that the estimated effect is causal?</li>
    <li>What could bias our estimation?</li>
  </ul>
</ul>
    
---

### 1. Causality

#### 1.1. Omitted variable bias

<ul>
  <li>The relationship could be impacted by many variables</li>
  <ul>
    <li>For instance, inflated by the fact that males tend to both be better paid and work part-time less often</li>
  </ul>
</ul>
    
--

<ul>
  <li>The variable for hours of work here acts as a <b>confounding factor</b> because it is correlated to both \(x\) and \(y\)</li>
  <ul>
    <li>We need to put it as a control variable</li>
  </ul>
</ul>
  
<p style = "margin-bottom:1.25cm;"></p>
    
--
    
$$\text{Earnings}_i = \hat{\alpha} + \hat{\beta_1}1\{\text{Sex}_i = \text{Male}\} + \hat{\beta_2}\text{Hours}_i  + \hat{\varepsilon_i}$$
    
--
    
<p style = "margin-bottom:1.25cm;"></p>
    
```{r}
summary(lm(Earnings ~ Sex + Hours, asec_2020))$coefficients
```
  
---
    
### 1. Causality

#### 1.1. Omitted variable bias
    
<ul>
  <li>The coefficient of the variable Sex drops from 21,612.33 in the univariate regression to 13,794.39 when including sex in the regression</li>
  <ul>
    <li>Why?</li>
  </ul>
</ul>
    
<p style = "margin-bottom:1.25cm;"></p>
    
--

<ul>
  <li>Part of the estimated effect of sex on earnings was due to the fact that men tend to work more hours per week</li>
  <ul>
    <li>This effect is now captured by the coefficient associated to the variable for hours of work</li>
  </ul>
</ul>
    
<p style = "margin-bottom:1.25cm;"></p>
    
--
    
<ul>
  <li>There are plenty of omitted factors that could influence our estimates</li>
  <ul>
    <li>How would the coefficients change if we were to control for having an executive position?</li>
  </ul>
</ul>

<p style = "margin-bottom:1.75cm;"></p>

<center><h4><i> &#10140; We cannot consider this effect as causal! </i></h4></center>
    
---
    
### 1. Causality

#### 1.1. Omitted variable bias

 * When interpreting coefficients, you should be unambiguous about what the estimation actually means
 
--

<p style = "margin-bottom:.75cm;"></p>

<ul>
  <li>Here we would say that <i>''controlling for the number of hours worked per week, being a male relative to a female is associated with a $13,794.39 increase in annual earnings on average, <b>everything else equal</b>''</i>.</li>
  <ul>
    <li>Everything else equal (or <i>ceteris paribus</i>), means that the coefficient we estimate should be interpreted as the effect of \(x\) on \(y\) if everything else would remain constant when varying \(x\)</li>
  </ul>
</ul>

--

<p style = "margin-bottom:.75cm;"></p>

<ul>
  <li>Being a male relative to a female is also likely to be associated with an increase in the probability to have an executive position</li>
  <ul>
    <li>But having an executive position would also increase the expected annual earnings</li>
    <li>So when we say <i>ceteris paribus</i>, we say that the effect we estimate is attributable to the Sex variable <i>assuming that when the Sex variable changes other factors remain constant</i></li>
  </ul>
</ul>

--

<p style = "margin-bottom:.75cm;"></p>
 
<ul>
  <li>We know this assumption is not correct &#10140; we should mention it not because we believe it is the case but to be clear about what the coefficient means</li>
</ul>

---
    
### 1. Causality

#### 1.2. Selection bias and counterfactual

<ul>
  <li>Omitted variable bias is a common problem</i>
  <ul>
    <li>But estimations can be biased for many other reasons</i>
  </ul>
</ul>

--

 * Remember the example about candidates to a position from last time:

.left-column[

```{r, echo = F, fig.width = 6, fig.height = 3.5, out.width = "80%"}
ggplot(data_bin, aes(x = x, y = y)) +
  geom_point(alpha = .2, color = "#014D64") + xlab("Grade") +
  geom_smooth(method = "lm", se = F, color = "#014D64") +
  scale_y_continuous(name = "", limits = c(-.5, 1.5), breaks = 0:1)
```

]

--

.right-column[

<p style = "margin-bottom:-.25cm;"></p>

* We estimated that having a 1 unit increase in Grade (/20) would increase the probability to be accepted by about a third on expectation, *ceteris paribus*

<ul>
  <li>What do you think about this effect?</i>
  <ul>
    <li>Look at the support of the \(x\) variable</i>
  </ul>
</ul>
 
]

---
    
### 1. Causality

#### 1.2. Selection bias and counterfactual

<ul>
  <li>The fact that grades range from 12 to 18 hints at a selection problem:</i>
  <ul>
    <li>Individuals with very low grade won't apply to the position because they know they will be rejected</i>
    <li>Individuals with very high grade won't apply to the position because they apply to better positions</i>
  </ul>
</ul>

--

.left-column[

```{r, echo = F, fig.width = 6, fig.height = 3.5, out.width = "80%"}
data_bin2 <- data_bin %>%
  mutate(Observation = "Observed")%>%
  bind_rows(data_bin %>%
              mutate(x = ifelse(y == 0, x - 2, x + 2),
                     Observation = "Unobserved"))

ggplot(data_bin2, aes(x = x, y = y)) +
  geom_smooth(method = "lm", se = F, color = "black", linetype = "dashed") +
  geom_smooth(data = data_bin, aes(x = x, y = y), method = "lm", se = F, color = "#014D64") +
  geom_point(alpha = .1, aes(x = x, y = y, color = Observation)) + xlab("Grade") +
  scale_y_continuous(name = "", limits = c(-.5, 1.5), breaks = 0:1) +
  guides(color = guide_legend(override.aes = list(alpha = 1) ) )
```

]

.right-column[

<p style = "margin-bottom:-.25cm;"></p>

<ul>
  <li>Had these individuals applied, the estimated effect would be lower</li>
</ul>

<ul>
  <li>Here the estimated coefficient is specific to a sample which is not representative of the whole population</li>
  <ul>
    <li>Issue of <b>external validity</b></li>
    <li>The interpretation only holds in our specific setting, we cannot extrapolate</li>
  </ul>
</ul>
 
] 

---
    
### 1. Causality

#### 1.2. Selection bias and counterfactual

  * Such selection problems are very common threats to causality

--

<p style = "margin-bottom:.5cm;"></p>

<ul>
  <li>What is the impact of going to a better neighborhood on your children outcomes?</li>
  <ul>
    <li>Those who move may be different from those who stay: <b>self-selection issue</b></li>
    <li>Here it is not that the sample is not representative of the population, but that <b>the outcomes of those who stayed are different from the outcomes those who moved would have had, if they had stayed</b></li>
  </ul>
</ul>

--

<p style = "margin-bottom:.5cm;"></p>

<ul>
  <li>This related to the notion of <b>counterfactual</b></li>
  <ul>
    <li>If those who moved were comparable to those who stayed, it would be valid to use the outcome of those who stayed as the counterfactual outcome of those who moved, i.e., the outcome they would have if they had stayed</li>
    <li>But because of selection we do not have a credible counterfactual</li>
  </ul>
</ul>

--

<p style = "margin-bottom:.5cm;"></p>

<ul>
  <li>The notion of counterfactual is key to answer many questions</li>
  <ul>
    <li>What is the impact of an immigrant inflow on the labor market outcomes of locals?</li>
    <li>We need to know how the labor market outcomes of locals would have evolved absent the immigrant inflow but we do not observe this situation</li>
  </ul>
</ul>

---

### Overview

<p style = "margin-bottom:1.75cm;">

#### 1. Causality &#10004;
<p style = "margin-bottom:-.5cm;">
 * 1.1. Omitted variable bias
 * 1.2. Selection bias and counterfactual

#### 2. Randomness
<p style = "margin-bottom:-.5cm;">
 * 2.1. Data Generating Process & Random variables
 * 2.2. Theoretical vs. empirical moments
 * 2.3. $\beta$ vs. $\hat{\beta}$

#### 3. Causality from randomness
<p style = "margin-bottom:-.5cm;">
 * 3.1. Randomized Controlled Trials
 * 3.2. Types of randomization
 * 3.3. Multiple testing

#### 4. Wrap up!

---

### Overview

<p style = "margin-bottom:1.75cm;">

#### 1. Causality &#10004;
<p style = "margin-bottom:-.5cm;">
 * 1.1. Omitted variable bias
 * 1.2. Selection bias and counterfactual

#### 2. Randomness
<p style = "margin-bottom:-.5cm;">
 * 2.1. Data Generating Process & Random variables
 * 2.2. Theoretical vs. empirical moments
 * 2.3. $\beta$ vs. $\hat{\beta}$

---

### 2. Randomness

#### 2.1. Data Generating Process & Random variables

 * So far in practice we have used many variables such as age, sex, earnings, etc.
  * But when we were working on theory we referred to these variable $x$ and $y$

--

<p style = "margin-bottom:1.75cm;"></p>

 * In Statistics and Econometrics these $x$ and $y$ we manipulate are called random variables
  * These variables can take values according to a data generating process (DGP)
  * The data generating process is the mechanism that causes the data to be the way we observe it

--

<p style = "margin-bottom:1.75cm;"></p>

 * For instance your grades can be seen as a random variable
  * Which takes given values according to an unknown data generating process
  * The DGP probably depends on how much effort you exert, on your background, on many environmental factors, ...

---

### 2. Randomness

#### 2.1. Data Generating Process & Random variables

<ul>
  <li>Consider for instance the outcome of two dice as a random variable</li>
  <ul>
    <li>Contrarily to the variables we usually study, we know the DGP of this one</li>
  </ul>
</ul>

--

 * The DGP causes our random variable to take the following values with the following probabilities:

.pull-left[

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 - 1/36 (&#x2680;&#x2680;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 - 2/36 (&#x2680;&#x2681; - &#x2681;&#x2680;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4 - 3/36 (&#x2680;&#x2682; - &#x2682;&#x2680; - &#x2681;&#x2681;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5 - 4/36 (&#x2681;&#x2682; - &#x2682;&#x2681; - &#x2681;&#x2683; - &#x2683;&#x2681;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6 - 5/36 (&#x2682;&#x2682; - &#x2681;&#x2683; - &#x2683;&#x2681; - &#x2684;&#x2680; - &#x2680;&#x2684;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7 - 6/36 (&#x2682;&#x2683; - &#x2683;&#x2682; - &#x2684;&#x2681; - &#x2681;&#x2684; - &#x2680;&#x2685; - &#x2685;&#x2680;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8 - 5/36 (&#x2683;&#x2683; - &#x2684;&#x2682; - &#x2682;&#x2684; - &#x2685;&#x2681; - &#x2681;&#x2685;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9 - 4/36 (&#x2683;&#x2684; - &#x2684;&#x2683; - &#x2685;&#x2682; - &#x2682;&#x2685;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10 - 3/36 (&#x2685;&#x2683; - &#x2683;&#x2685; - &#x2684;&#x2684;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11 - 2/36 (&#x2685;&#x2684; - &#x2684;&#x2685;)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12 - 1/36 (&#x2685;&#x2685;)  

]

.pull-right[
```{r, echo = F, fig.width = 6, fig.height = 4, out.width = "100%"}
tibble(Outcome = 2:12,
       Probability = c(1:6, 5, 4, 3, 2, 1)/36) %>%
  ggplot(., aes(x = Outcome, y = Probability)) +
  geom_bar(stat = "identity", fill = "#6794A7", color = "#014D64", alpha = .5, width = 1) +
  scale_x_continuous(breaks = 2:12)
```

]
---

### 2. Randomness

#### 2.2. Theoretical vs. empirical moments

 * Because we know the data generating process of our random variable, we can compute its expected value:
 
$$\begin{align} \text{E}\left[X\right] = \frac{(2\times1) + (3\times2) + (4\times3) + (5\times4) + (6\times5) + (7\times6)}{36} +\\ \frac{(8\times5) + (9\times4) + (10\times3) + (11\times2) + (12\times1)}{36} = \frac{252}{36} = 7\end{align}$$

--

<p style = "margin-bottom:1.25cm;"></p>

<ul>
  <li>Note that we talk about <b>expected value</b> for the <b>theoretical moment</b> of the distribution, while we talk about the <b>mean value</b> for its <b>empirical counterpart</b></li>
  <ul>
    <li>For a given number of draws the mean won't necessarily be exactly 7</li>
    <li>But if we were to do infinitely many draws, the mean would converge towards 7</li>
  </ul>
</ul>

--

<p style = "margin-bottom:1.25cm;"></p>

<center><h4><i>Let's try it out!</i></h4></center>

---

### 2. Randomness

#### 2.2. Theoretical vs. empirical moments

<ul>
  <li>We can simulate the data generating process by:</b></li>
  <ul>
    <li>Storing every possible outcome in a vector</li>
    <li>Randomly picking outcomes from this vector with the function sample()</li>
  </ul>
</ul>

--

```{r}
outcomes <- c(2, 3, 3, 4, 4, 4, 5, 5, 5, 5, 6, 6, 6, 
              6, 6, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 
              9, 9, 9, 9, 10, 10, 10, 11, 11, 12)

sample(outcomes, 10, replace = T)
```

--

 * The `replace` argument of the sample() function allows to indicate whether we want each randomly drawn value to be *'replaced'* before the next draw or removed from the vector 


<p style = "margin-bottom:1cm;"></p>

<center><h4><i>Let's have a look at the distribution of outcomes for different numbers of draws</i></h4></center>

---

### 2. Randomness

#### 2.2. Theoretical vs. empirical moments

```{r, echo = F, fig.width = 8, fig.height = 3, out.width = "85%"}
simulations <- tibble(
  Values = c(sample(outcomes, 10, replace = T), sample(outcomes, 50, replace = T),
             sample(outcomes, 1000, replace = T)),
  Draws = c(rep("10 Draws", 10), rep("50 Draws", 50), rep("1000 Draws", 1000)),
  Order = c(rep(1, 10), rep(2, 50), rep(3, 1000))
) 

ggplot(simulations, aes(x = Values)) + 
  geom_bar(stat = "count", fill = "#6794A7", color = "#014D64", alpha = .5, width = 1) + 
  facet_wrap(~reorder(Draws, Order), scales = "free_y", nrow = 1) +
  scale_x_continuous(breaks = 2:12)
```

<ul>
  <li>The larger the number of draws the closer the mean to the expected value (here 5.2, 7.06, and 6.95)</li>
  <ul>
    <li>If we were to roll two dice infinitely many times the mean would converge towards its expected value</li>
    <li>This is what we call the <i>Law of Large Numbers</i> (LLN)</li>
  </ul>
</ul>

---

### 2. Randomness

#### 2.2. Theoretical vs. empirical moments

<ul>
  <li>In this respect, we can view the mean as an estimation of the expected value</li>
  <ul>
    <li>So just like we computed a standard error to get a sense of how far \(\hat{\beta}\) is likely to be from the true \(\beta\)...</li>
    <li>... we can compute a standard error to get a sense of how far \(\overline{X}\) is likely to be from \(\text{E}\left[X\right]\)</li>
  </ul>
</ul>

--

<p style = "margin-bottom:1cm;"></p>

* The formula of the standard error writes:

$$SE(\overline{X}) = \frac{SD(X)}{\sqrt{N}}$$

--

<p style = "margin-bottom:1cm;"></p>

* And the reasoning for the 95% confidence interval is the same as with $\hat{\beta}$

$$\text{Pr}\left[\overline{X} - t_{97.5\%}\times\text{se}(\overline{X})\leq \text{E}\left[X\right] \leq\overline{X} + t_{97.5\%}\times\text{se}(\overline{X})\right] = 95\%$$

--

<ul><ul>
<li>With \(t_{97.5\%}\) computed from a student t distribution with N-1 degrees of freedom</li>
</ul></ul>
 
---

### 2. Randomness

#### 2.2. Theoretical vs. empirical moments

 * Just like the mean that we compute empirically is an estimate of the first moment of the distribution,
  * the variance that we compute empirically is an estimate of the second moment of the distribution

--

.pull-left[

.pull-left[

<p style = "margin-bottom:4cm;"></p>

<b>First moment:</b>  

<p style = "margin-bottom:3.5cm;"></p>

<b>Second moment:</b>

]

.pull-right[

<center><h4>Theoretical moment</h4></center>

$$\text{E}(X_{\text{discrete}}) = \sum_{i=1}^{k}x_ip_i$$

$$\text{E}(X_{\text{continuous}}) = \int_{\text{R}}xf(x)dx$$

<p style = "margin-bottom:2cm;"></p>

$$\text{Var}(X) = \text{E}\left[(X - \text{E}(X))^2\right] \equiv \sigma^2$$

]

]

.pull-right[

<center><h4>Empirical moment</h4></center>

<p style = "margin-bottom:1.9cm;"></p>

$$\overline{X} = \frac{1}{N}\sum_{i=1}^Nx_i$$

<p style = "margin-bottom:2.25cm;"></p>

$$\hat{\sigma}^2 = \frac{1}{N}\sum_{i=1}^N(x_i-\bar{x})^2$$

]

---

### 2. Randomness

#### 2.3. $\beta$ vs. $\hat{\beta}$

<ul>
  <li>The distinction we made between \(\beta\) and \(\hat{\beta}\) is of the same nature</li>
  <ul>
    <li>Let's illustrate that with a little simulation exercise</li>
  </ul>
</ul>

--

<ul>
  <li>The function mvrnorm from the MASS package generates two normally distributed random variables</li>
  <ul>
    <li>According to: their <b>covariance</b> and respective <b>expected value</b> and <b>variance</b></li>
  </ul>
</ul>

--

`data <- mvrnorm(n = #observations, mu = c(E[X1], E[X2]), Sigma = covariance matrix)`

.pull-left[

 * The covariance matrix should be of the form

```{r, echo = F}
kable(tibble(` ` = c("X1", "X2"),
             X1 = c("Var(X1)", "Cov(X2, X1)"),
             X2 = c("Cov(X1, X2)", "Var(X2)")),
      caption = "Variance-covariance matrix", align = 'ccc') %>%
  column_spec(1, bold = T)
```

]

--

.pull-right[

 * For instance, with $\text{Var}(X_1) = 1$, $\text{Var}(X_2) = 2$, and $\text{Cov}(X_1, X_2) = .5$:
 
```{r}
matrix(c(1, .5, .5, 2), nrow = 2)
```

]

---

### Practice

**1) Use the `mvrnorm` function from the `MASS` package to generate two variables $X$ and $Y$ with:**
 * $N = 1000$
 * $\text{E}\left[X\right] = 5$
 * $\text{E}\left[Y\right] = 30$
 * $\text{Var}(X) = 2$
 * $\text{Var}(Y) = 10$
 * $\text{Cov}(X, Y) = 4$

--

<p style = "margin-bottom:1cm;"></p>

**2) Compute the empirical counterpart of the first and second moments of the joint distribution**

--

<p style = "margin-bottom:2cm;"></p>

<center><h3><i>You've got 5 minutes!</i></h3></center>

---

### Solution

 * Generate the joint distribution

```{r}
library(MASS)
data <- mvrnorm(1000, c(5, 30), matrix(c(2, 4, 4, 10), 2))
x <- data[, 1]
y <- data[, 2]
```

--

 * First empirical moment
 
```{r}
c(mean(x), mean(y))
```

--

 * Second empirical moment

```{r}
matrix(c(var(x), cov(x, y), cov(y, x), var(y)), 2)
```

---

### 2. Randomness

#### 2.3. $\beta$ vs. $\hat{\beta}$

 * Because we know the joint DGP of $X$ and $Y$, we do know the actual values of $\alpha$ and $\beta$ from the regression
 
$$y_i = \alpha + \beta x_i + \varepsilon_i$$

--

<p style = "margin-bottom:1cm;"></p>

$$\beta = \frac{\text{Cov}(X, Y)}{\text{Var}(X)} = \frac{4}{2} = 2$$

$$\alpha = \text{E}\left[Y\right] - \beta\times\text{E}\left[X\right] = 30 - 2\times5 = 20$$

<p style = "margin-bottom:1cm;"></p>

--

 * And the coefficients $\hat{\alpha}$ and $\hat{\beta}$ we can compute using observed data are estimates of these true parameters
 
```{r}
summary(lm(y ~ x))$coefficients
```

---

### 2. Randomness

#### 2.3. $\beta$ vs. $\hat{\beta}$

 * The higher the number of observations, the closer $\hat{\beta}$ from $\beta$ on expectation:
 
```{r, eval = F}
beta_hat <- function(n){
  data <- mvrnorm(n, c(5, 30), matrix(c(2, 4, 4, 10), 2))
  x <- data[, 1]
  y <- data[, 2]
  return(summary(lm(y ~ x))$coefficients[2, 1])
}
c(beta_hat(10), beta_hat(1000), beta_hat(100000))
```

--

```{r, echo = F}
beta_hat <- function(n){
  data <- mvrnorm(n, c(5, 30), matrix(c(2, 4, 4, 10), 2))
  x <- data[, 1]
  y <- data[, 2]
  return(summary(lm(y ~ x))$coefficients[2, 1])
}
c(beta_hat(10), beta_hat(1000), beta_hat(100000))
```

--

<p style = "margin-bottom:1.25cm;"></p>

<ul>
  <li>This is what we call <i>consistency</i></li>
  <ul>
    <li>With this DGP the OLS estimator is consistent</li>
    <li>But this is not always the case</li>
    <li>You'll see the conditions for that next year</li>
  </ul>
</ul>

---

### 2. Randomness

#### 2.3. $\beta$ vs. $\hat{\beta}$

<ul>
  <li>Keep in mind that consistency, unbiasedness, and precision, are very distinct concepts</li>
  <ul>
    <li>Consider these 4 cases where we compare the distribution of estimations \(\hat{\beta}\) from 1,000 randomly drawn samples to the true \(\beta\)</li>
  </ul>
</ul>

--

.left-column[

<p style = "margin-bottom:-.25cm;"></p>

```{r, echo = F, fig.width = 7, fig.height = 4, out.width = "90%"}
tibble(Estimation = c(rnorm(1000, 2, .1), rnorm(1000, 3, .1), 
                      rnorm(1000, 2, 1), rnorm(1000, 3, 1)),
       Precision = rep(c("Precise", "Imprecise"), each = 2000),
       Biasedness = rep(rep(c("Unbiased", "Biased"), each = 1000), 2)) %>%
  ggplot(., aes(x = Estimation)) +
  geom_density(fill = "#6794A7", color = "#014D64", alpha = .8, bw = .5) + facet_grid(Precision ~ Biasedness) +
  geom_vline(xintercept = 2, linetype = "dashed") +
  scale_x_continuous(limits = c(0, 5))
```
]


--

.right-column[

<p style = "margin-bottom:-.5cm;"></p>


<ul>
  <li>An estimator is <b>unbiased</b> if on expectation it gives the true value we want to estimate</li>
</ul>

<p style = "margin-bottom:.5cm;"></p>

<ul>
  <li>An estimator is <b>precise</b> if the estimations it provides are close to each other (low variance)</li>
</ul>

<p style = "margin-bottom:.5cm;"></p>

<ul>
  <li>An estimator is <b>consistent</b> if the larger the sample size the higher the probability that we obtain the true value we want to estimate</li>
</ul>

  
]

---

### Overview

<p style = "margin-bottom:1.75cm;">

#### 1. Causality &#10004;
<p style = "margin-bottom:-.5cm;">
 * 1.1. Omitted variable bias
 * 1.2. Selection bias and counterfactual

#### 2. Randomness &#10004;
<p style = "margin-bottom:-.5cm;">
 * 2.1. Data Generating Process & Random variables
 * 2.2. Theoretical vs. empirical moments
 * 2.3. $\beta$ vs. $\hat{\beta}$

#### 3. Causality from randomness
<p style = "margin-bottom:-.5cm;">
 * 3.1. Randomized Controlled Trials
 * 3.2. Types of randomization
 * 3.3. Multiple testing

#### 4. Wrap up!

---

### Overview

<p style = "margin-bottom:1.75cm;">

#### 1. Causality &#10004;
<p style = "margin-bottom:-.5cm;">
 * 1.1. Omitted variable bias
 * 1.2. Selection bias and counterfactual

#### 2. Randomness &#10004;
<p style = "margin-bottom:-.5cm;">
 * 2.1. Data Generating Process & Random variables
 * 2.2. Theoretical vs. empirical moments
 * 2.3. $\beta$ vs. $\hat{\beta}$

#### 3. Causality from randomness
<p style = "margin-bottom:-.5cm;">
 * 3.1. Randomized Controlled Trials
 * 3.2. Types of randomization
 * 3.3. Multiple testing

---

### 3. Causality from randomness

#### 3.1. Randomized Controlled Trials

<ul>
  <li>A Randomized Controlled Trial (RCT) is a type of experiment in which the thing we want to know the impact of (called the treatment) is randomly allocated in the population</li>
  <ul>
    <li>It is a way to obtain causality from randomness</li>
  </ul>
</ul>

--

Take for instance the `asec_2020.csv` dataset we've been working with:

```{r}
asec_2020 %>% group_by(n()) %>%
  summarise(`Mean Earnings` = mean(Earnings),
         `% Female` = 100 * mean(Sex == "Female"),
         `% Black` = 100 * mean(Race == "Black"),
         `% Asian` = 100 * mean(Race == "Asian"),
         `% Other` = 100 * mean(Race == "Other"),
         `Mean Hours` = mean(Hours))
```


---

### 3. Causality from randomness

#### 3.1. Randomized Controlled Trials

 * Let's compare the average characteristics for two randomly selected groups:
 
--

```{r}
asec_2020 %>%
  mutate(Group = ifelse(rnorm(n(), 0, 1) > 0, 1, 0)) %>%
  group_by(Group) %>%
  summarise(`Mean Earnings` = mean(Earnings),
            `% Female` = 100 * mean(Sex == "Female"),
            `% Black` = 100 * mean(Race == "Black"),
            `% Asian` = 100 * mean(Race == "Asian"),
            `% Other` = 100 * mean(Race == "Other"),
            `Mean Hours` = mean(Hours))
```

---

### 3. Causality from randomness

#### 3.1. Randomized Controlled Trials

<ul>
  <li>Their average characteristics are very close!</li>
  <ul>
    <li>On expectation their average characteristics are the same</li>
  </ul>
</ul>

--

<ul>
  <li>And just as the two randomly selected populations are comparable in terms of their observable characteristics</li>
  <ul>
    <li>On expectation they are also <b>comparable</b> in terms of their <b>unobservable characteristics!</b></li>
    <li>Randomization, if properly conducted, thus solves the problem of omitted variable bias</li>
  </ul>
</ul>

--

<center><h4><i>If we assign a treatment to Group 1, Group 2 would then be a valid counterfactual to estimate a causal effect!</i></h4></center>

--

<ul>
  <li>But RCTs are not immune to every problem:</li>
  <ul>
    <li>If individuals self-select in participating to the experiment their would be a selection bias</li>
    <li>Even without self-selection, if the population among which treatment is randomized is not representative there is a problem of external validity</li>
    <li>For the RCT to work, individuals should comply with the treatment allocation</li>
    <li>The sample must be sufficiently large for the average characteristics across groups to be close enough to their expected value</li>
    <li>...</li>
  </ul>
</ul>

---

### 3. Causality from randomness

#### 3.2. Types of randomization

 * To some extent their are ways to deal with these problems 

--

<ul>
  <li>For instance if we want to ensure that a characteristic is well balanced among the two groups, we can <b>randomize within categories of this variable</b></li>
  <ul>
    <li>Instead of giving the treatment randomly and hoping that we will obtain the same % of females in both groups</li>
    <li>We assign the treatment randomly among females and among males separately</li>
    <li>This is called <b>randomizing by block</b></li>
    <li><i>Note that this only works with observable characteristics!</i></li>
  </ul>
</ul>

--

<p style = "margin-bottom:1cm;"></p>

```{r, eval = F}
asec_2020 %>%
  group_by(Sex) %>% # Randomize treatment by sex
  mutate(Group = ifelse(rnorm(n(), 0, 1) > 0, 1, 0)) %>%
  ungroup() %>% group_by(Group) %>%
  summarise(...)
```

---

### 3. Causality from randomness

#### 3.2. Types of randomization

<ul>
  <li>Now imagine that you want to estimate the impact of calory intake at the 10am break on pupils grades</li>
  <ul>
    <li>You regularly give a snack to a sample of randomly selected children and a few months later you test whether there is a significant difference between their grades and that of untreated children</li>
    <li>Do you expect the estimated effect to reflect the actual impact you aim to measure?</li>
  </ul>
</ul>

--

<ul>
  <li>What if some children shared their snack with untreated children?</li>
  <ul>
    <li>These <i>treated children</i> would have <i>less calories</i> and then possibly lower grades than under full compliance</li>
    <li>And their <i>untreated</i> friends would have <i>more calories</i> than expected and then possibly higher grades</li>
    <li>Thus, this <b><i>spillover effect</i></b> would tend to fallaciously shrink the observed effect of the treatment</li>
  </ul>
</ul>

--

.left-column[

<p style = "margin-bottom:.75cm;"></p>

<ul>
  <li>One solution to that problem is to <b>randomize by cluster</b></li>
  <ul>
    <li>Instead of considering the treatment to be at the child level</li>
    <li>Consider that the treatment is a the school level</li>
    <li>A treated unit is a school where some/all children are treated</li>
    <li>An untreated school is a school where no child is treated</li>
  </ul>
</ul>
]

--

.right-column[
<center><i>Beware that in terms of inference, computing standard errors the usual way while the treatment is at a broader observational level than the outcome would give fallaciously low standard errors, which would need to be corrected</i></center>
]

---

### 3. Causality from randomness

#### 3.3. Multiple testing

<ul>
  <li>Another inference issue that RCTs can be subject to is multiple testing</li>
  <ul>
    <li>If you conduct a well-designed RCT you might be tempted to exploit the causal framework to test a myriad of effects</li>
  </ul>
</ul>

--

<ul>
  <li>You randomize your treatment and you compare the averages of many outcomes between treated and untreated individuals</li>
  <ul>
    <li>You would be tempted to conclude that there is a significant effect for every variable whose corresponding p-value is lower that .05</li>
    <li>But you cannot do that!</li>
  </ul>
</ul>

--

<ul>
  <li>The probability to have a p-value lower than .05 just by chance for one test is indeed 5%</li>
  <ul>
    <li>But if you do multiple tests in a row, the probability to have a p-value lower than .05 among these multiple tests is greater than 5%</li>
    <li>The greater the number of tests you perform, the higher the probability to get a significant result just by chance</li>
  </ul>
</ul>

--

<center><h4>This is what we call <i>multiple testing</i></h4></center>

---

### 3. Causality from randomness

#### 3.3. Multiple testing
 
```{r, echo = F, fig.width = 7, fig.height = 4, out.width = "75%"}
tibble(ntest = 1:50,
       proba = 1 - (.95^ntest)) %>%
  ggplot(., aes(x = ntest, y = proba)) + 
  geom_point(alpha = .8, color = "#6794A7") +
  scale_x_continuous("Number of tests", breaks = c(1, seq(10, 50, 10))) +
  scale_y_continuous("Probability to find at least\n one significant variable",
                     limits = 0:1, breaks = c(.05, seq(.2, 1, .2)),
                     labels = paste0(100*c(.05, seq(.2, 1, .2)), "%")) +
  geom_segment(x = 1, xend = 1, y = 0, yend = .05, linetype = "dashed") +
  geom_segment(x = 0, xend = 1, y = .05, yend = .05, linetype = "dashed") 
```


---

### 3. Causality from randomness

#### 3.3. Multiple testing

 * There are many ways to correct for multiple testing

<p style = "margin-bottom:1.25cm;"></p>

--

<ul>
  <li>The simplest one is called the <b>Bonferroni</b> correction</li>
  <ul>
    <li>It consists in <b>multiplying the p-value by the number of tests</b></li>
    <li>But it also leads to a large <b>loss of power</b> (the probability to find an effect when there is indeed an effect decreases a lot)</li>
  </ul>
</ul>

<p style = "margin-bottom:1.25cm;"></p>

--

<ul>
  <li>There are more sophisticated ways to deal with the problem, which can be categorized into two approaches</li>
  <ul>
    <li><b>Family Wise Error Rate</b>: Control the probability that there is at least one true assumption rejected</li>
    <li><b>False Discovery Rate</b>: Control the share of true assumptions among rejected assumptions</li>
  </ul>
</ul>

<p style = "margin-bottom:1.25cm;"></p>

--

<center><i>&#10140; We won't cover these methods in this course but keep the multiple testing issue in mind when you encounter a long series of statistical tests</i></center>

---

### Overview

<p style = "margin-bottom:1.75cm;">

#### 1. Causality &#10004;
<p style = "margin-bottom:-.5cm;">
 * 1.1. Omitted variable bias
 * 1.2. Selection bias and counterfactual

#### 2. Randomness &#10004;
<p style = "margin-bottom:-.5cm;">
 * 2.1. Data Generating Process & Random variables
 * 2.2. Theoretical vs. empirical moments
 * 2.3. $\beta$ vs. $\hat{\beta}$

#### 3. Causality from randomness &#10004;
<p style = "margin-bottom:-.5cm;">
 * 3.1. Randomized Controlled Trials
 * 3.2. Types of randomization
 * 3.3. Multiple testing

#### 4. Wrap up!

---

### 4. Wrap up!

#### Causality 

<p style = "margin-bottom:-.5cm;"></p>

.pull-left[

1) Omitted variable bias

<p style = "margin-bottom:1.5cm;"></p>

<ul>
  <li>Regressing Earnings on Sex = Male without controls yields \(\hat{\beta} = 21612.33\)</li>
</ul>

<ul>
  <li>But controlling for weekly hours we obtain \(\hat{\beta} = 13794.39\)</li>
</ul>

<p style = "margin-bottom:1.5cm;"></p>

&#10140; Variables that are correlated to both $x$ and $y$ should be controlled for  

&#10140; And the coefficients must unambiguously be interpreted <i>ceteris paribus</i>

]

--

.pull-left[

2) Selection bias

<p style = "margin-bottom:-.35cm;"></p>
 
```{r, echo = F, fig.width = 7, fig.height = 4, out.width = "100%"}
ggplot(data_bin2, aes(x = x, y = y)) +
  geom_smooth(method = "lm", se = F, color = "black", linetype = "dashed") +
  geom_smooth(data = data_bin, aes(x = x, y = y), method = "lm", se = F, color = "#014D64") +
  geom_point(alpha = .1, aes(x = x, y = y, color = Observation)) + xlab("Grade") +
  scale_y_continuous(name = "", limits = c(-.5, 1.5), breaks = 0:1) +
  guides(color = guide_legend(override.aes = list(alpha = 1) ) )
```

<p style = "margin-bottom:-.35cm;"></p>

<ul><ul>
  <li>Self-selection selection into the population studied causes problems of <b>external validity</b></li>
  <li>Self-selection into the treatment variable causes problems of <b>counterfactual validity</b></li>
</ul></ul>

]

---

### 4. Wrap up!

#### Theoretical vs. empirical moments

<p style = "margin-bottom:1.25cm;"></p>

.pull-left[

.pull-left[

<p style = "margin-bottom:4cm;"></p>

<b>First moment:</b>  

<p style = "margin-bottom:3.5cm;"></p>

<b>Second moment:</b>

]

.pull-right[

<center><h4>Theoretical moment</h4></center>

$$\text{E}(X_{\text{discrete}}) = \sum_{i=1}^{k}x_ip_i$$

$$\text{E}(X_{\text{continuous}}) = \int_{\text{R}}xf(x)dx$$

<p style = "margin-bottom:2cm;"></p>

$$\text{Var}(X) = \text{E}\left[(X - \text{E}(X))^2\right] \equiv \sigma^2$$

]

]

.pull-right[

<center><h4>Empirical moment</h4></center>

<p style = "margin-bottom:1.9cm;"></p>

$$\overline{X} = \frac{1}{N}\sum_{i=1}^Nx_i$$

<p style = "margin-bottom:2.25cm;"></p>

$$\hat{\sigma}^2 = \frac{1}{N}\sum_{i=1}^N(x_i-\bar{x})^2$$

]

---

### 4. Wrap up!

#### $\beta$ vs. $\hat{\beta}$

<ul>
  <li>Keep in mind that consistency, unbiasedness, and precision, are very distinct concepts</li>
  <ul>
    <li>Consider these 4 cases where we compare the distribution of estimations \(\hat{\beta}\) from 1,000 randomly drawn samples to the true \(\beta\)</li>
  </ul>
</ul>

--

.left-column[

<p style = "margin-bottom:-.25cm;"></p>

```{r, echo = F, fig.width = 7, fig.height = 4, out.width = "90%"}
tibble(Estimation = c(rnorm(1000, 2, .1), rnorm(1000, 3, .1), 
                      rnorm(1000, 2, 1), rnorm(1000, 3, 1)),
       Precision = rep(c("Precise", "Imprecise"), each = 2000),
       Biasedness = rep(rep(c("Unbiased", "Biased"), each = 1000), 2)) %>%
  ggplot(., aes(x = Estimation)) +
  geom_density(fill = "#6794A7", color = "#014D64", alpha = .8, bw = .5) + facet_grid(Precision ~ Biasedness) +
  geom_vline(xintercept = 2, linetype = "dashed") +
  scale_x_continuous(limits = c(0, 5))
```
]


--

.right-column[

<p style = "margin-bottom:-.5cm;"></p>


<ul>
  <li>An estimator is <b>unbiased</b> if on expectation it gives the true value we want to estimate</li>
</ul>

<p style = "margin-bottom:.5cm;"></p>

<ul>
  <li>An estimator is <b>precise</b> if the estimations it provides are close to each other (low variance)</li>
</ul>

<p style = "margin-bottom:.5cm;"></p>

<ul>
  <li>An estimator is <b>consistent</b> if the larger the sample size the higher the probability that we obtain the true value we want to estimate</li>
</ul>

  
]


---

### 4. Wrap up!

#### Randomized controlled trials 

<ul>
  <li>A Randomized Controlled Trial (RCT) is a type of experiment in which the thing we want to know the impact of (called the treatment) is randomly allocated in the population</li>
  <ul>
    <li>It is a way to obtain causality from randomness as on expectation two randomly drawn population have the same average observable and unobservable characteristics, which solves the omitted variable bias</li>
  </ul>
</ul>

--

.pull-left[

<p style = "margin-bottom:1.75cm;"></p>

<ul>
  <li>But RCTs are not immune to every problem:</li>
  <ul>
    <li>Self-selection issues can arise</li>
    <li>The population should be representative for external validity</li>
    <li>Individuals should comply with the treatment allocation</li>
    <li>The sample must be sufficiently large</li>
    <li>...</li>
  </ul>
</ul>

]

--

.pull-right[

<ul>
  <li>There are different types of randomization to help dealing with such problems</li>
  <ul>
    <li><b>Randomization by block for small samples:</b> Randomly assign the treatment within groups of individuals whose characteristic should be balanced</li>
    <li><b>Randomization by cluster for spillovers:</b> If spillovers may occur within given units, consider these units as the observational level for the treatment allocation</li>
    <li>...</li>
  </ul>
</ul>

]


