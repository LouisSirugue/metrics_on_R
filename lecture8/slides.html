<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Univariate regressions</title>
    <meta charset="utf-8" />
    <meta name="author" content=" Louis SIRUGUE" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/plotly-binding/plotly.js"></script>
    <script src="libs/typedarray/typedarray.min.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main/plotly-latest.min.js"></script>
    <link href="libs/countdown/countdown.css" rel="stylesheet" />
    <script src="libs/countdown/countdown.js"></script>
    <link rel="shortcut icon" href="star.png" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Univariate regressions
## Lecture 8
### <br>Louis SIRUGUE
### CPES 2 - Fall 2022

---






### Part I recap

#### Import data


```r
fb &lt;- read.csv("C:/User/Documents/ligue1.csv", encoding = "UTF-8")
```


--

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

#### Class


```r
is.numeric("1.6180339") # What would be the output?
```

--


```
## [1] FALSE
```

--

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

#### Subsetting


```r
fb$Home[3]
```

```
## [1] "Troyes"
```

---

### Part I recap

#### Distributions

  * The **distribution** of a variable documents all its possible values and how frequent they are

--

&lt;img src="slides_files/figure-html/unnamed-chunk-7-1.png" width="95%" style="display: block; margin: auto;" /&gt;

--

&lt;p style = "margin-bottom:-1cm;"&gt;

 * We can describe a distribution with:
  
---

### Part I recap

#### Distributions

  * The **distribution** of a variable documents all its possible values and how frequent they are

&lt;img src="slides_files/figure-html/unnamed-chunk-8-1.png" width="95%" style="display: block; margin: auto;" /&gt;

&lt;p style = "margin-bottom:-1cm;"&gt;

 * We can describe a distribution with:
  * Its **central tendency**

---

### Part I recap

#### Distributions

  * The **distribution** of a variable documents all its possible values and how frequent they are

&lt;img src="slides_files/figure-html/unnamed-chunk-9-1.png" width="95%" style="display: block; margin: auto;" /&gt;

&lt;p style = "margin-bottom:-1cm;"&gt;

 * We can describe a distribution with:
  * Its **central tendency**
  * And its **spread**
  
---

### Part I recap

#### Central tendency

--

.pull-left[

 * The **mean** is the sum of all values divided by the number of observations

`$$\bar{x} = \frac{1}{N}\sum_{i = 1}^Nx_i$$` 

]

--

.pull-right[

 * The **median** is the value that divides the (sorted) distribution into two groups of equal size

`$$\text{Med}(x) = \begin{cases} x[\frac{N+1}{2}] &amp; \text{if } N \text{ is odd}\\
\frac{x[\frac{N}{2}]+x[\frac{N}{2}+1]}{2} &amp; \text{if } N \text{ is even}
\end{cases}$$`

]

--

#### Spread

--

.pull-left[

 * The **standard deviation** is square root of the average squared deviation from the mean

`$$\text{SD}(x) = \sqrt{\text{Var}(x)} = \sqrt{\frac{1}{N}\sum_{i = 1}^N(x_i-\bar{x})^2}$$`
 
]

--

.pull-right[

&lt;p style = "margin-bottom:-5.5cm;"&gt;&lt;/p&gt;

 * The **interquartile range** is the difference between the maximum and the minimum value from the middle half of the distribution

&lt;p style = "margin-bottom:1cm;"&gt;&lt;/p&gt;

$$\text{IQR} = Q_3 - Q_1 $$

]

---

### Part I recap

#### Inference

&lt;ul&gt; 
  &lt;li&gt;In Statistics, we view variables as a given realization of a &lt;b&gt;data generating process&lt;/b&gt;&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;Hence, the &lt;b&gt;mean&lt;/b&gt; is what we call an &lt;b&gt;empirical moment&lt;/b&gt;, which is an &lt;b&gt;estimation&lt;/b&gt;...&lt;/li&gt;
    &lt;li&gt;... of the &lt;b&gt;expected value&lt;/b&gt;, the &lt;b&gt;theoretical moment&lt;/b&gt; of the DGP we're interested in&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

--

&lt;ul&gt; 
  &lt;li&gt;To know how confident we can be in this estimation, we need to compute a &lt;b&gt;confidence interval&lt;/b&gt;&lt;/li&gt;
&lt;/ul&gt;

`$$[\bar{x} - t_{n-1, \:97.5\%}\times\frac{\text{SD}(x)}{\sqrt{n}}; \:\bar{x} + t_{n-1, \:97.5\%}\times\frac{\text{SD}(x)}{\sqrt{n}}]$$`

--

&lt;ul&gt;
  &lt;ul&gt;
    &lt;li&gt;It gets &lt;b&gt;larger&lt;/b&gt; as the &lt;b&gt;variance&lt;/b&gt; of the distribution of \(x\) increases&lt;/li&gt;
    &lt;li&gt;And gets &lt;b&gt;smaller&lt;/b&gt; as the &lt;b&gt;sample size&lt;/b&gt; \(n\) increases&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

--

&lt;img src="slides_files/figure-html/unnamed-chunk-10-1.png" width="95%" style="display: block; margin: auto;" /&gt;

---

### Part I recap

#### Packages


```r
library(dplyr)
```

--

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

#### Main dplyr functions

.left-column[
&lt;table class="table table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Function &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Meaning &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; mutate() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Modify or create a variable &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; select() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Keep a subset of variables &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; filter() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Keep a subset of observations &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; arrange() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Sort the data &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; group_by() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Group the data &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; summarise() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Summarizes variables into 1 observation per group &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.right-column[
&lt;img style = "margin-top:0cm; margin-left:1.5cm;" src = "pipe.png" width = "180"/&gt;
]

---

### Part I recap

#### Merge data


```r
a &lt;- data.frame(x = c(1, 2, 3), y = c("a", "b", "c"))
b &lt;- data.frame(x = c(4, 5, 6), y = c("d", "e", "f"))
c &lt;- data.frame(x = 1:6, z = c("alpha", "bravo", "charlie", "delta", "echo", "foxtrot"))
```

--


```r
a %&gt;% bind_rows(b) %&gt;% left_join(c, by = "x")
```

&lt;table class="table table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; x &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; y &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; z &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; a &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; alpha &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; b &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; bravo &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; c &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; charlie &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; d &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; delta &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; e &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; echo &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; f &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; foxtrot &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

### Part I recap

#### Reshape data

&lt;table class="table table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; share_tertiary &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; share_gdp &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; FRA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 44.69 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.40 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 46.52 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.21 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--

&lt;p style = margin-bottom:1.25cm;"&gt;&lt;/p&gt;


```r
data %&gt;% pivot_longer(c(share_tertiary, share_gdp), names_to = "Variable", values_to = "Value")
```

&lt;p style = margin-bottom:1.25cm;"&gt;&lt;/p&gt;

--

&lt;table class="table table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Variable &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Value &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; FRA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; share_tertiary &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 44.69 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; FRA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; share_gdp &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.40 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; share_tertiary &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 46.52 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; share_gdp &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.21 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---

### Part I recap

&lt;p style = "margin-bottom:2cm;"&gt;

&lt;center&gt;&lt;h4&gt; The 3 core components of the ggplot() function &lt;/h4&gt;&lt;/center&gt;

&lt;table class="table table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Component &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Contribution &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Implementation &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Data &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Underlying values &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; ggplot(data, | data %&amp;gt;% ggplot(., &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Mapping &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Axis assignment &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; aes(x = V1, y = V2, ...)) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Geometry &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Type of plot &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; + geom_point() + geom_line() + ... &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p style = "margin-bottom:2cm;"&gt;

--

 * Any **other element** should be added with a **`+` sign**


```r
ggplot(data, aes(x = V1, y = V2)) + 
  geom_point() + geom_line() +
  anything_else()
```

---

### Part I recap

.pull-left[
&lt;p style = "margin-bottom:1.75cm;"&gt;
&lt;center&gt;&lt;h4&gt; Main customization tools &lt;/h4&gt;&lt;/center&gt;
&lt;table class="table table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Item to customize &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Main functions &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Axes &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; scale_[x/y]_[continuous/discrete] &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Baseline theme &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; theme_[void/minimal/.../dark]() &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Annotations &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; geom_[[h/v]line/text](), annotate() &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Theme &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; theme(axis.[line/ticks].[x/y] = ..., &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.pull-right[
&lt;center&gt;&lt;h4&gt; Main types of geometry &lt;/h4&gt;&lt;/center&gt;
&lt;table class="table table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Geometry &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Function &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Bar plot &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; geom_bar() &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Histogram &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; geom_histogram() &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Area &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; geom_area() &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Line &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; geom_line() &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Density &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; geom_density() &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Boxplot &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; geom_boxplot() &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Violin &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; geom_violin() &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Scatter plot &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; geom_point() &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

### Part I recap

.pull-left[

&lt;center&gt;&lt;h4&gt; Main types of aesthetics &lt;/h4&gt;&lt;/center&gt;

&lt;table class="table table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Argument &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Meaning &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; alpha &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; opacity from 0 to 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; color &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; color of the geometry &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; fill &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; fill color of the geometry &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; size &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; size of the geometry &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; shape &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; shape for geometries like points &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; linetype &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; solid, dashed, dotted, etc. &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.pull-right[

&lt;p style = "margin-bottom:3.25cm;"&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;If specified &lt;b&gt;in the geometry&lt;/b&gt;&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;It will apply uniformly to every &lt;b&gt;all the geometry&lt;/b&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
 
&lt;p style = "margin-bottom:1cm;"&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;If assigned to a variable &lt;b&gt;in aes&lt;/b&gt;&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;it will &lt;b&gt;vary with the variable&lt;/b&gt; according to a scale documented in legend&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
]

&lt;br&gt;

--


```r
ggplot(data, aes(x = V1, y = V2, size = V3)) + 
  geom_point(color = "steelblue", alpha = .6)
```


---

### Part I recap

#### R Markdown: Three types of content

.left-column[

&lt;img src = "report_example_3.png" width = "700"/&gt;

]

.right-column[
&lt;p style = "margin-bottom:1.5cm;"&gt;

&lt;b&gt;YAML header&lt;/b&gt;

&lt;p style = "margin-bottom:1.75cm;"&gt;

&lt;b&gt;Code chunks&lt;/b&gt;

&lt;p style = "margin-bottom:5cm;"&gt;

&lt;b&gt;Text&lt;/b&gt;
]

---

### Part I recap

#### Useful features

&amp;#10140; **Inline code** allows to include the output of some **R code within text areas** of your report

&lt;p style = "margin-bottom:-.5cm;"&gt;

--

.pull-left[
&lt;center&gt; &lt;h4&gt; Syntax &lt;/h4&gt; &lt;/center&gt;


```r
`paste("a", "b", sep = "-")`
```


```r
`r paste("a", "b", sep = "-")`
```

]

.pull-right[
&lt;center&gt; &lt;h4&gt; Output &lt;/h4&gt; &lt;/center&gt;

`paste("a", "b", sep = "-")`

&lt;p style = "margin-bottom:1cm;"&gt;

a-b
 
]

&lt;p style = "margin-bottom:2cm;"&gt;

--

&amp;#10140; **`kable()`** for clean **html tables** and **`datatable()`** to navigate in **large tables**
 

```r
kable(results_table)
datatable(results_table)
```

---

### Part I recap

#### LaTeX for equations

 * `\(\LaTeX\)` is a convenient way to display **mathematical** symbols and to structure **equations**
  * The **syntax** is mainly based on **backslashes \ and braces {}**

--

&lt;p style = "margin-bottom:1cm;"&gt;

&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;#10140; What you **type** in the text area: `$x \neq \frac{\alpha \times \beta}{2}$`  
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;#10140; What is **rendered** when knitting the document: `\(x \neq \frac{\alpha \times \beta}{2}\)`

--

&lt;p style = "margin-bottom:1.5cm;"&gt;

&lt;center&gt;To &lt;b&gt;include&lt;/b&gt; a &lt;b&gt;LaTeX equation&lt;/b&gt; in R Markdown, you simply have to surround it with the &lt;b&gt;$ sign&lt;/b&gt;&lt;/center&gt;

&lt;p style = "margin-bottom:0cm;"&gt;

.pull-left[

&lt;h4 style = "margin-bottom:0cm;"&gt;The mean formula with one `$` on each side&lt;/h4&gt;  
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;#10140; For inline equations  
 
`\(\overline{x}=\frac{1}{N}\sum_{i=1}^N x_i\)` 

]

.pull-right[

&lt;h4 style = "margin-bottom:0cm;"&gt;The mean formula with two `$` on each side&lt;/h4&gt;  
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;#10140; For large/emphasized equations  
 
`$$\overline{x}=\frac{1}{N}\sum_{i=1}^N x_i$$` 

]

---

&lt;h3&gt;Today: &lt;i&gt;We start Econometrics!&lt;/i&gt;&lt;/h3&gt;

--

&lt;p style = "margin-bottom:3cm;"&gt;&lt;/p&gt;

.pull-left[

&lt;ul style = "margin-left:1.5cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;1. Joint distributions&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;1.1. Definition&lt;/li&gt;
    &lt;li&gt;1.2. Covariance&lt;/li&gt;
    &lt;li&gt;1.3. Correlation&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

&lt;ul style = "margin-left:1.5cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;2. Univariate regressions&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;2.1. Introduction to regressions&lt;/li&gt;
    &lt;li&gt;2.2. Coefficients estimation&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

]

.pull-right[

&lt;ul style = "margin-left:-1cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;3. Binary variables&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;3.1. Binary dependent variables&lt;/li&gt;
    &lt;li&gt;3.2. Binary independent variables&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
 
&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

&lt;ul style = "margin-left:-1cm;list-style: none"&gt;&lt;li&gt;&lt;b&gt;4. Wrap up!&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;
]

---

&lt;h3&gt;Today: &lt;i&gt;We start Econometrics!&lt;/i&gt;&lt;/h3&gt;


&lt;p style = "margin-bottom:3cm;"&gt;&lt;/p&gt;

.pull-left[

&lt;ul style = "margin-left:1.5cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;1. Joint distributions&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;1.1. Definition&lt;/li&gt;
    &lt;li&gt;1.2. Covariance&lt;/li&gt;
    &lt;li&gt;1.3. Correlation&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
]

---

### 1. Joint distributions

#### 1.1. Definition

&lt;ul&gt;
  &lt;li&gt;The &lt;b&gt;joint distribution&lt;/b&gt; shows the &lt;b&gt;values&lt;/b&gt; and associated &lt;b&gt;frequencies&lt;/b&gt; for &lt;b&gt;two variables&lt;/b&gt; simultaneously&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;Remember how the &lt;b&gt;density&lt;/b&gt; could represent the distribution of a &lt;b&gt;single variable&lt;/b&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom: 2cm;"&gt;&lt;/p&gt;

--

.pull-left[
&lt;p style = "margin-bottom: 1cm;"&gt;&lt;/p&gt;
&lt;img src="slides_files/figure-html/unnamed-chunk-28-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;img src="slides_files/figure-html/unnamed-chunk-29-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

### 1. Joint distributions

#### 1.1. Definition

&lt;ul&gt;
  &lt;li&gt;The &lt;b&gt;joint distribution&lt;/b&gt; shows the &lt;b&gt;values&lt;/b&gt; and associated &lt;b&gt;frequencies&lt;/b&gt; for &lt;b&gt;two variables&lt;/b&gt; simultaneously&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;Remember how the &lt;b&gt;density&lt;/b&gt; could represent the distribution of a &lt;b&gt;single variable&lt;/b&gt;&lt;/li&gt;
    &lt;li&gt;The &lt;b&gt;joint density&lt;/b&gt; can represent the joint distribution of &lt;b&gt;two variables&lt;/b&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom: 1.25cm;"&gt;&lt;/p&gt;

.pull-left[
&lt;img src="slides_files/figure-html/unnamed-chunk-30-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

.pull-right[
<div id="htmlwidget-1818623aac80f2134d61" style="width:100%;height:375px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1818623aac80f2134d61">{"x":{"visdat":{"28ec77555284":["function () ","plotlyVisDat"]},"cur_data":"28ec77555284","attrs":{"28ec77555284":{"x":[-0.0807095806719289,0.307916442595626,0.69654246586318,1.08516848913073,1.47379451239829,1.86242053566584,2.2510465589334,2.63967258220095,3.02829860546851,3.41692462873606,3.80555065200362,4.19417667527117,4.58280269853873,4.97142872180628,5.36005474507383,5.74868076834139,6.13730679160894,6.5259328148765,6.91455883814405,7.30318486141161,7.69181088467916,8.08043690794672,8.46906293121427,8.85768895448182,9.24631497774938],"y":[-3.30568873578819,-1.79530948768298,-0.284930239577762,1.22544900852745,2.73582825663267,4.24620750473788,5.7565867528431,7.26696600094831,8.77734524905353,10.2877244971587,11.798103745264,13.3084829933692,14.8188622414744,16.3292414895796,17.8396207376848,19.34999998579,20.8603792338952,22.3707584820005,23.8811377301057,25.3915169782109,26.9018962263161,28.4122754744213,29.9226547225265,31.4330339706318,32.943413218737],"z":[[0.00024508886410526,0.000167519136787181,7.23264479565564e-05,8.7790748227019e-05,0.000150997725375558,0.000145057695075036,9.33086576110266e-05,7.27038055999315e-05,5.89007062776598e-05,4.05050077072412e-05,2.03254513334412e-05,5.8175859371393e-06,9.62161967798373e-07,1.00138715757e-07,5.9047321191474e-09,1.66978438769237e-10,2.07912182555249e-12,1.11061078159493e-14,2.62688008037698e-17,4.21108910311574e-20,1.22275994895103e-22,2.99557108321877e-25,3.36498074091128e-28,1.63480594649313e-31,3.68029069171043e-35],[0.000190410558866371,0.000180769966980471,0.000169730037917858,0.000273290647847732,0.000425153163935444,0.00040179905960646,0.000293890135190469,0.000274346666737066,0.000240944593695991,0.000180748469593847,0.000102523178456552,3.7089468309811e-05,8.63883386991101e-06,1.17114843916792e-06,7.75852023639417e-08,2.28129983729178e-09,2.90193255183716e-11,1.74364445236043e-13,1.0132024417135e-15,9.88162929997035e-18,5.96240494831403e-20,1.59599285563772e-22,1.86490762513196e-25,1.03468995779599e-28,5.7335205694112e-32],[0.000181224135326733,0.000303372716416055,0.000400745385844619,0.000536235996145626,0.000681677337549412,0.000613676869725022,0.000491829972740464,0.000500209151714657,0.000444433674355811,0.000357268421874213,0.000251229939721038,0.000127959553539725,3.96005451822329e-05,6.13142050430614e-06,4.26875915763742e-07,1.31699768677606e-08,2.23003058960697e-10,5.09964757657508e-12,1.40563350966373e-13,2.02619820275674e-15,1.29348936095228e-17,3.67538915274733e-20,5.13840940171888e-23,6.86304609426317e-26,2.34241392076309e-28],[0.000225698174491013,0.000432569723507913,0.000643042298053052,0.000913275926088243,0.00113533247406491,0.000991090738817961,0.000702150094274123,0.000591419914263935,0.000470771664273875,0.000389692243468388,0.000358748393348194,0.00024119481142929,8.59257989334876e-05,1.43104009587808e-05,1.14626249200425e-06,6.53781160103376e-08,5.19988567903116e-09,3.50382055893124e-10,1.1824708937556e-11,1.80648394139002e-13,1.26990236409184e-15,4.60117523026591e-18,1.49116271513345e-20,9.91001181217751e-23,7.76507411368617e-25],[0.000150271307581504,0.00035064815848264,0.00073477812400342,0.00134026972969151,0.00183765430080911,0.00172973539719237,0.00127045372615812,0.00097102425296357,0.000716406026183231,0.000528865449746625,0.000454485572182241,0.000306394229123308,0.000119193545689801,2.77837237884181e-05,5.33272795104367e-06,1.05907533720786e-06,1.55192445734476e-07,1.19968992878276e-08,4.41142262610415e-10,7.85865025780023e-12,7.58856409719853e-14,5.96095624645547e-16,7.68679187838861e-18,1.09265062233149e-19,1.53606758845227e-21],[6.24119278458045e-05,0.000243053096183372,0.000762590282034262,0.00164814006513693,0.00242260012941292,0.00262283367237308,0.00250739309891553,0.00229981339092836,0.00181506147918392,0.00129208767202061,0.00095676971911064,0.000629774768070952,0.000317532452839975,0.000127584789555953,4.50138247631201e-05,1.2676627421307e-05,2.16602514531694e-06,1.92964916932064e-07,8.95062131770275e-09,2.34151019351187e-10,4.43667317668071e-12,1.0930849155116e-13,2.93116076767344e-15,6.99356275035407e-17,1.6168256192813e-18],[6.2626149361263e-05,0.000248121596339015,0.000778430450040387,0.00181255736075202,0.0029085085032159,0.00366813810757154,0.00434050157864386,0.00455395609434902,0.00387987994023496,0.00298336832540319,0.00237355416945188,0.00173028582598385,0.00100088165759343,0.000481560174887576,0.000212643352727932,7.34916098168515e-05,1.57612189425519e-05,1.93552905763632e-06,1.36342761413542e-07,6.20026428914048e-09,2.90065844144593e-10,1.48006873423392e-11,6.12151073007542e-13,2.55413007685167e-14,7.76317127314241e-16],[0.000121143279621856,0.000338251799187226,0.000760933741335707,0.00167268752404723,0.0029416523864437,0.00443713871599664,0.00617688655031233,0.00712671710158522,0.00668600175020978,0.0056442768382145,0.0047550876213392,0.00361913393803194,0.00218794919047284,0.00114178019765277,0.000590633730141234,0.000268414684811363,8.35161546379139e-05,1.52320011184313e-05,1.65049230671502e-06,1.48849045738758e-07,1.41086619903676e-08,1.05150708318334e-09,7.36002000975674e-11,4.62061980722657e-12,1.56179005930779e-13],[0.000164695248007628,0.000419109215896729,0.000781852466718564,0.00149399614759455,0.00277117636894741,0.00504909969443222,0.00799449347647854,0.00994915800030133,0.0102237251814344,0.00936521158859288,0.00819086059540012,0.00653389102869522,0.00438082395755761,0.00256482025299413,0.00149860112559463,0.000857843018505115,0.000353034526139715,8.7994385858981e-05,1.56695228726469e-05,2.64088690261489e-06,3.5907064222804e-07,4.06886210497744e-08,4.79219436751567e-09,3.64447480781066e-10,1.28576286555828e-11],[0.000163734395856942,0.000421449235046482,0.000787815909106694,0.00141274719103996,0.00263426866714312,0.00524355716751522,0.00882459025307898,0.0117381620265093,0.0131621313952342,0.0130636778141653,0.0120741436445235,0.0104598237268857,0.00812424146347652,0.00556043859114935,0.00361642857142264,0.00227019648568594,0.00110433599667666,0.000378497973796525,0.000107496298365604,2.54283984620084e-05,4.62947711442006e-06,8.97392711108625e-07,1.45343777701539e-07,1.19138170092644e-08,4.59258642118339e-10],[0.000105698042728928,0.00028472327733279,0.00058653021569802,0.00111652430323269,0.00209104071130724,0.00412908109420448,0.00717745112080265,0.0106467946082711,0.0134469627028029,0.0144406769021941,0.0144082760946084,0.0138106183938481,0.0120774989017395,0.00947073953462061,0.00698040310634433,0.0047840143100954,0.00266547110608762,0.00117089509206891,0.000431222862527625,0.000122630486279018,3.33767373621186e-05,1.0107554216934e-05,1.88044464918342e-06,1.67407019820231e-07,1.07313363541868e-08],[3.35917879074518e-05,0.000104471946287874,0.000284484583227917,0.00068758042777027,0.00144189297143841,0.00285349101678307,0.00521275098166967,0.00887482897712672,0.0125695997891398,0.0144832820336467,0.0158648145071123,0.0169437063097732,0.0161939884436551,0.013823110264595,0.0111226818484894,0.00808917966447274,0.00482656929787473,0.00242429356616441,0.00100392569341886,0.000335456761091181,0.000136346039319028,5.18188721367311e-05,1.06463381568742e-05,1.41350123198429e-06,2.9147425927652e-07],[4.86943486708112e-06,2.1851841832187e-05,9.77461592046792e-05,0.000345945877574711,0.000943961784043773,0.0020995260196014,0.00410147306196285,0.00741670227455732,0.0113166420973374,0.0144476646176569,0.0173405015414363,0.0197728644569728,0.0200728687669769,0.0180502087891812,0.0150563192753757,0.0111748442697816,0.0070010028522458,0.00386088254467724,0.00170891347080988,0.000647204204305829,0.000311519189688014,0.00012859136502462,3.68812633666579e-05,1.3007511349809e-05,5.37028026030551e-06],[3.75736310691724e-07,3.27752904980953e-06,2.47397035465481e-05,0.000130709002787979,0.000493114241782798,0.00135099236913248,0.00291215932770932,0.00543768642794668,0.00914757863658738,0.0135217856079256,0.0174342368657174,0.0202250577879243,0.0214652472835183,0.0206323472791175,0.0181329528582846,0.0141995824734955,0.00967263116943062,0.00569582566521872,0.00269050153811706,0.00115226137091431,0.000549276993952921,0.000249105329402732,0.000134404322582895,8.77430067036306e-05,4.3463259226413e-05],[2.21777065066045e-08,4.00056118202214e-07,5.32743414891302e-06,4.71281707030015e-05,0.000249271812256972,0.000788021384247752,0.00171389404314381,0.00329265417225719,0.00642385372394773,0.010950120081894,0.0147926433442889,0.0173481085132007,0.0195532270009159,0.0206702055864396,0.0197825504824914,0.0171021707784054,0.0130738898681633,0.00824257350150588,0.00427127153160665,0.00212821768386483,0.00106317262838741,0.000530904292991443,0.000360797280687722,0.000271473987306319,0.000143616190343555],[1.87501644262129e-09,8.78037371961113e-08,2.28308819047505e-06,2.86571373050481e-05,0.000171261250180513,0.000524531722969894,0.00102487820662003,0.00194007628283342,0.00412352887806835,0.00749759651156003,0.0104099802647696,0.0126947807869547,0.0156053342164982,0.0181937116261072,0.0190710528608872,0.0184529420190078,0.0159247736919704,0.011113481343508,0.0063944242414771,0.00344709387661223,0.00183057778246135,0.000946235717116305,0.000549407002331392,0.000369666327210076,0.000194537368677811],[5.07693394256865e-10,3.5834700074278e-08,1.14158100215058e-06,1.65814473771028e-05,0.000113034453372813,0.000386007912424376,0.000791589274697231,0.00140076594701756,0.00266044564697693,0.00467105649838188,0.00671082182971635,0.00875354209066886,0.0115263737149161,0.0145114439397501,0.0169013004173229,0.0181277436584727,0.0167803237809734,0.0126008922395469,0.00791396214055714,0.0046055284854342,0.00277345420232642,0.00158592108365667,0.000735200338358304,0.000312681213159186,0.000125412944814758],[1.22497764954968e-10,1.02650949425139e-08,3.94740126993429e-07,7.04753806195244e-06,5.93808355770679e-05,0.00024612593815486,0.000566664973701473,0.000951744550050911,0.0015958254863228,0.00276114501124644,0.00429321338434277,0.00593868399705315,0.00783621238573187,0.0105944561912246,0.0142373972712683,0.0166432394298943,0.0156812348194728,0.0120666422068287,0.00807688896501388,0.00520960487233541,0.00358690107009297,0.00229375755406125,0.00110382500578199,0.000399523625078348,0.000106805135122989],[1.93347130434717e-11,1.97227215961558e-09,9.22153300298317e-08,1.98550118151217e-06,1.98909781251555e-05,9.56823211259165e-05,0.00024502912473472,0.000438680623267004,0.000787323079655774,0.00149505833110908,0.0026712742471583,0.00398914963144027,0.00509964351584582,0.00718510483111149,0.0107007167230121,0.0132454251436394,0.0130341952567732,0.0107133602757255,0.00769044934493349,0.00512756553761777,0.00363195303362467,0.00250368870646697,0.00143600828760207,0.000665674399891047,0.000204965246030645],[1.912057496264e-12,2.27849996002806e-10,1.23515784392188e-08,3.05442332602582e-07,3.46431078414199e-06,1.85525498878934e-05,5.31158288145929e-05,0.000114939007332455,0.000261615747251441,0.00061826889618101,0.00141745735270904,0.00246545932750151,0.00325507591859467,0.00454824970684511,0.00669457932280118,0.00847427210105388,0.00914877434089516,0.0084984714305509,0.00656942749908512,0.00437385359133838,0.00319077267800438,0.00244252890873677,0.0016923657158858,0.000973552480660144,0.00037623245154863],[1.01309617355628e-13,1.36644370971991e-11,8.32750462337522e-10,2.28281860898409e-08,2.82083779996723e-07,1.63707456130071e-06,5.40602316465833e-06,1.58806833648559e-05,5.11131329704449e-05,0.00018056273793146,0.000585729333627918,0.00123788699743014,0.00181767894753618,0.00253141494134087,0.00352591043717523,0.00453562825411178,0.00545123534074509,0.00574989756343374,0.00478912360919753,0.00343448843217141,0.00296671357062352,0.0026669290256236,0.00203850173125768,0.00127175726254755,0.000627179019585995],[2.64391179687404e-15,3.9541130468617e-13,2.62883958512948e-11,7.7138893299159e-10,1.00711123737439e-08,6.30780920826172e-08,2.60459769781679e-07,1.17091404010268e-06,6.4223070519356e-06,3.97967694763019e-05,0.000174215228431157,0.000446258062984927,0.000814092354721191,0.00130921849945535,0.00179692553075494,0.00226454648764132,0.00301584866051295,0.00375738290644251,0.00357802995552679,0.00297445019445136,0.00294457288713906,0.00283089075172355,0.0021583243649575,0.00135174230237115,0.000771337061258896],[3.24366421611113e-17,5.21889830627297e-15,3.66261116001612e-13,1.11802269469686e-11,1.51925192276937e-10,1.06387026102579e-09,6.36499481194371e-09,5.37393801216153e-08,6.26938428398947e-07,5.9186361834799e-06,3.15424960479865e-05,0.000106252868653342,0.000290580117601996,0.000594097895044633,0.000792568935307815,0.000911488869476369,0.00138859630454462,0.00218731685646112,0.00253650669490231,0.00242392570421794,0.00236857341243181,0.00215261271339804,0.00156971878699431,0.000941578982141071,0.000523704456941824],[1.77496084760789e-19,2.98017455269471e-17,2.15353823268818e-15,6.72986252069613e-14,9.5841827714638e-13,8.31817709020049e-12,9.48277279362666e-11,2.00764576576656e-09,4.09553751219711e-08,4.73477066852972e-07,3.22738879543151e-06,1.7465084478523e-05,7.23946973540746e-05,0.00016994294290451,0.000214822946380703,0.000231181651212602,0.000452851452217872,0.000948924751016775,0.0013719530795912,0.00148943716287497,0.00136615553591948,0.00110112684027814,0.000788423484786217,0.000476015173205125,0.000222530974917274],[4.13217336909082e-22,7.09136854244541e-20,5.20370656667621e-18,1.65936657299091e-16,2.58572826409946e-15,3.61911681416909e-14,1.21396277913803e-12,5.29574797595419e-11,1.35383339281867e-09,1.92945613242329e-08,2.11667637450606e-07,1.90235019969928e-06,9.79540822053264e-06,2.39196104159438e-05,2.89239619691129e-05,3.35883313869489e-05,0.00010049590353559,0.000290540824228266,0.000547550731260621,0.000699049686457391,0.000616720905553448,0.000439462383578763,0.000362923140733237,0.000270104584704502,0.000113152087049296]],"colorscale":"YlGnBu","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"plot_bgcolor":"#DFE6EB","paper_bgcolor":"#DFE6EB","fig_bgcolor":"#DFE6EB","scene":{"camera":{"eye":{"x":0,"y":-1,"z":0.75},"center":{"x":0,"y":0,"z":-0.25}},"aspectratio":{"x":0.9,"y":0.8,"z":0.4},"xaxis":{"title":"Variable A"},"yaxis":{"title":"Variable B"},"zaxis":{"title":"Joint density"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":"YlGnBu","showscale":true,"x":[-0.0807095806719289,0.307916442595626,0.69654246586318,1.08516848913073,1.47379451239829,1.86242053566584,2.2510465589334,2.63967258220095,3.02829860546851,3.41692462873606,3.80555065200362,4.19417667527117,4.58280269853873,4.97142872180628,5.36005474507383,5.74868076834139,6.13730679160894,6.5259328148765,6.91455883814405,7.30318486141161,7.69181088467916,8.08043690794672,8.46906293121427,8.85768895448182,9.24631497774938],"y":[-3.30568873578819,-1.79530948768298,-0.284930239577762,1.22544900852745,2.73582825663267,4.24620750473788,5.7565867528431,7.26696600094831,8.77734524905353,10.2877244971587,11.798103745264,13.3084829933692,14.8188622414744,16.3292414895796,17.8396207376848,19.34999998579,20.8603792338952,22.3707584820005,23.8811377301057,25.3915169782109,26.9018962263161,28.4122754744213,29.9226547225265,31.4330339706318,32.943413218737],"z":[[0.00024508886410526,0.000167519136787181,7.23264479565564e-05,8.7790748227019e-05,0.000150997725375558,0.000145057695075036,9.33086576110266e-05,7.27038055999315e-05,5.89007062776598e-05,4.05050077072412e-05,2.03254513334412e-05,5.8175859371393e-06,9.62161967798373e-07,1.00138715757e-07,5.9047321191474e-09,1.66978438769237e-10,2.07912182555249e-12,1.11061078159493e-14,2.62688008037698e-17,4.21108910311574e-20,1.22275994895103e-22,2.99557108321877e-25,3.36498074091128e-28,1.63480594649313e-31,3.68029069171043e-35],[0.000190410558866371,0.000180769966980471,0.000169730037917858,0.000273290647847732,0.000425153163935444,0.00040179905960646,0.000293890135190469,0.000274346666737066,0.000240944593695991,0.000180748469593847,0.000102523178456552,3.7089468309811e-05,8.63883386991101e-06,1.17114843916792e-06,7.75852023639417e-08,2.28129983729178e-09,2.90193255183716e-11,1.74364445236043e-13,1.0132024417135e-15,9.88162929997035e-18,5.96240494831403e-20,1.59599285563772e-22,1.86490762513196e-25,1.03468995779599e-28,5.7335205694112e-32],[0.000181224135326733,0.000303372716416055,0.000400745385844619,0.000536235996145626,0.000681677337549412,0.000613676869725022,0.000491829972740464,0.000500209151714657,0.000444433674355811,0.000357268421874213,0.000251229939721038,0.000127959553539725,3.96005451822329e-05,6.13142050430614e-06,4.26875915763742e-07,1.31699768677606e-08,2.23003058960697e-10,5.09964757657508e-12,1.40563350966373e-13,2.02619820275674e-15,1.29348936095228e-17,3.67538915274733e-20,5.13840940171888e-23,6.86304609426317e-26,2.34241392076309e-28],[0.000225698174491013,0.000432569723507913,0.000643042298053052,0.000913275926088243,0.00113533247406491,0.000991090738817961,0.000702150094274123,0.000591419914263935,0.000470771664273875,0.000389692243468388,0.000358748393348194,0.00024119481142929,8.59257989334876e-05,1.43104009587808e-05,1.14626249200425e-06,6.53781160103376e-08,5.19988567903116e-09,3.50382055893124e-10,1.1824708937556e-11,1.80648394139002e-13,1.26990236409184e-15,4.60117523026591e-18,1.49116271513345e-20,9.91001181217751e-23,7.76507411368617e-25],[0.000150271307581504,0.00035064815848264,0.00073477812400342,0.00134026972969151,0.00183765430080911,0.00172973539719237,0.00127045372615812,0.00097102425296357,0.000716406026183231,0.000528865449746625,0.000454485572182241,0.000306394229123308,0.000119193545689801,2.77837237884181e-05,5.33272795104367e-06,1.05907533720786e-06,1.55192445734476e-07,1.19968992878276e-08,4.41142262610415e-10,7.85865025780023e-12,7.58856409719853e-14,5.96095624645547e-16,7.68679187838861e-18,1.09265062233149e-19,1.53606758845227e-21],[6.24119278458045e-05,0.000243053096183372,0.000762590282034262,0.00164814006513693,0.00242260012941292,0.00262283367237308,0.00250739309891553,0.00229981339092836,0.00181506147918392,0.00129208767202061,0.00095676971911064,0.000629774768070952,0.000317532452839975,0.000127584789555953,4.50138247631201e-05,1.2676627421307e-05,2.16602514531694e-06,1.92964916932064e-07,8.95062131770275e-09,2.34151019351187e-10,4.43667317668071e-12,1.0930849155116e-13,2.93116076767344e-15,6.99356275035407e-17,1.6168256192813e-18],[6.2626149361263e-05,0.000248121596339015,0.000778430450040387,0.00181255736075202,0.0029085085032159,0.00366813810757154,0.00434050157864386,0.00455395609434902,0.00387987994023496,0.00298336832540319,0.00237355416945188,0.00173028582598385,0.00100088165759343,0.000481560174887576,0.000212643352727932,7.34916098168515e-05,1.57612189425519e-05,1.93552905763632e-06,1.36342761413542e-07,6.20026428914048e-09,2.90065844144593e-10,1.48006873423392e-11,6.12151073007542e-13,2.55413007685167e-14,7.76317127314241e-16],[0.000121143279621856,0.000338251799187226,0.000760933741335707,0.00167268752404723,0.0029416523864437,0.00443713871599664,0.00617688655031233,0.00712671710158522,0.00668600175020978,0.0056442768382145,0.0047550876213392,0.00361913393803194,0.00218794919047284,0.00114178019765277,0.000590633730141234,0.000268414684811363,8.35161546379139e-05,1.52320011184313e-05,1.65049230671502e-06,1.48849045738758e-07,1.41086619903676e-08,1.05150708318334e-09,7.36002000975674e-11,4.62061980722657e-12,1.56179005930779e-13],[0.000164695248007628,0.000419109215896729,0.000781852466718564,0.00149399614759455,0.00277117636894741,0.00504909969443222,0.00799449347647854,0.00994915800030133,0.0102237251814344,0.00936521158859288,0.00819086059540012,0.00653389102869522,0.00438082395755761,0.00256482025299413,0.00149860112559463,0.000857843018505115,0.000353034526139715,8.7994385858981e-05,1.56695228726469e-05,2.64088690261489e-06,3.5907064222804e-07,4.06886210497744e-08,4.79219436751567e-09,3.64447480781066e-10,1.28576286555828e-11],[0.000163734395856942,0.000421449235046482,0.000787815909106694,0.00141274719103996,0.00263426866714312,0.00524355716751522,0.00882459025307898,0.0117381620265093,0.0131621313952342,0.0130636778141653,0.0120741436445235,0.0104598237268857,0.00812424146347652,0.00556043859114935,0.00361642857142264,0.00227019648568594,0.00110433599667666,0.000378497973796525,0.000107496298365604,2.54283984620084e-05,4.62947711442006e-06,8.97392711108625e-07,1.45343777701539e-07,1.19138170092644e-08,4.59258642118339e-10],[0.000105698042728928,0.00028472327733279,0.00058653021569802,0.00111652430323269,0.00209104071130724,0.00412908109420448,0.00717745112080265,0.0106467946082711,0.0134469627028029,0.0144406769021941,0.0144082760946084,0.0138106183938481,0.0120774989017395,0.00947073953462061,0.00698040310634433,0.0047840143100954,0.00266547110608762,0.00117089509206891,0.000431222862527625,0.000122630486279018,3.33767373621186e-05,1.0107554216934e-05,1.88044464918342e-06,1.67407019820231e-07,1.07313363541868e-08],[3.35917879074518e-05,0.000104471946287874,0.000284484583227917,0.00068758042777027,0.00144189297143841,0.00285349101678307,0.00521275098166967,0.00887482897712672,0.0125695997891398,0.0144832820336467,0.0158648145071123,0.0169437063097732,0.0161939884436551,0.013823110264595,0.0111226818484894,0.00808917966447274,0.00482656929787473,0.00242429356616441,0.00100392569341886,0.000335456761091181,0.000136346039319028,5.18188721367311e-05,1.06463381568742e-05,1.41350123198429e-06,2.9147425927652e-07],[4.86943486708112e-06,2.1851841832187e-05,9.77461592046792e-05,0.000345945877574711,0.000943961784043773,0.0020995260196014,0.00410147306196285,0.00741670227455732,0.0113166420973374,0.0144476646176569,0.0173405015414363,0.0197728644569728,0.0200728687669769,0.0180502087891812,0.0150563192753757,0.0111748442697816,0.0070010028522458,0.00386088254467724,0.00170891347080988,0.000647204204305829,0.000311519189688014,0.00012859136502462,3.68812633666579e-05,1.3007511349809e-05,5.37028026030551e-06],[3.75736310691724e-07,3.27752904980953e-06,2.47397035465481e-05,0.000130709002787979,0.000493114241782798,0.00135099236913248,0.00291215932770932,0.00543768642794668,0.00914757863658738,0.0135217856079256,0.0174342368657174,0.0202250577879243,0.0214652472835183,0.0206323472791175,0.0181329528582846,0.0141995824734955,0.00967263116943062,0.00569582566521872,0.00269050153811706,0.00115226137091431,0.000549276993952921,0.000249105329402732,0.000134404322582895,8.77430067036306e-05,4.3463259226413e-05],[2.21777065066045e-08,4.00056118202214e-07,5.32743414891302e-06,4.71281707030015e-05,0.000249271812256972,0.000788021384247752,0.00171389404314381,0.00329265417225719,0.00642385372394773,0.010950120081894,0.0147926433442889,0.0173481085132007,0.0195532270009159,0.0206702055864396,0.0197825504824914,0.0171021707784054,0.0130738898681633,0.00824257350150588,0.00427127153160665,0.00212821768386483,0.00106317262838741,0.000530904292991443,0.000360797280687722,0.000271473987306319,0.000143616190343555],[1.87501644262129e-09,8.78037371961113e-08,2.28308819047505e-06,2.86571373050481e-05,0.000171261250180513,0.000524531722969894,0.00102487820662003,0.00194007628283342,0.00412352887806835,0.00749759651156003,0.0104099802647696,0.0126947807869547,0.0156053342164982,0.0181937116261072,0.0190710528608872,0.0184529420190078,0.0159247736919704,0.011113481343508,0.0063944242414771,0.00344709387661223,0.00183057778246135,0.000946235717116305,0.000549407002331392,0.000369666327210076,0.000194537368677811],[5.07693394256865e-10,3.5834700074278e-08,1.14158100215058e-06,1.65814473771028e-05,0.000113034453372813,0.000386007912424376,0.000791589274697231,0.00140076594701756,0.00266044564697693,0.00467105649838188,0.00671082182971635,0.00875354209066886,0.0115263737149161,0.0145114439397501,0.0169013004173229,0.0181277436584727,0.0167803237809734,0.0126008922395469,0.00791396214055714,0.0046055284854342,0.00277345420232642,0.00158592108365667,0.000735200338358304,0.000312681213159186,0.000125412944814758],[1.22497764954968e-10,1.02650949425139e-08,3.94740126993429e-07,7.04753806195244e-06,5.93808355770679e-05,0.00024612593815486,0.000566664973701473,0.000951744550050911,0.0015958254863228,0.00276114501124644,0.00429321338434277,0.00593868399705315,0.00783621238573187,0.0105944561912246,0.0142373972712683,0.0166432394298943,0.0156812348194728,0.0120666422068287,0.00807688896501388,0.00520960487233541,0.00358690107009297,0.00229375755406125,0.00110382500578199,0.000399523625078348,0.000106805135122989],[1.93347130434717e-11,1.97227215961558e-09,9.22153300298317e-08,1.98550118151217e-06,1.98909781251555e-05,9.56823211259165e-05,0.00024502912473472,0.000438680623267004,0.000787323079655774,0.00149505833110908,0.0026712742471583,0.00398914963144027,0.00509964351584582,0.00718510483111149,0.0107007167230121,0.0132454251436394,0.0130341952567732,0.0107133602757255,0.00769044934493349,0.00512756553761777,0.00363195303362467,0.00250368870646697,0.00143600828760207,0.000665674399891047,0.000204965246030645],[1.912057496264e-12,2.27849996002806e-10,1.23515784392188e-08,3.05442332602582e-07,3.46431078414199e-06,1.85525498878934e-05,5.31158288145929e-05,0.000114939007332455,0.000261615747251441,0.00061826889618101,0.00141745735270904,0.00246545932750151,0.00325507591859467,0.00454824970684511,0.00669457932280118,0.00847427210105388,0.00914877434089516,0.0084984714305509,0.00656942749908512,0.00437385359133838,0.00319077267800438,0.00244252890873677,0.0016923657158858,0.000973552480660144,0.00037623245154863],[1.01309617355628e-13,1.36644370971991e-11,8.32750462337522e-10,2.28281860898409e-08,2.82083779996723e-07,1.63707456130071e-06,5.40602316465833e-06,1.58806833648559e-05,5.11131329704449e-05,0.00018056273793146,0.000585729333627918,0.00123788699743014,0.00181767894753618,0.00253141494134087,0.00352591043717523,0.00453562825411178,0.00545123534074509,0.00574989756343374,0.00478912360919753,0.00343448843217141,0.00296671357062352,0.0026669290256236,0.00203850173125768,0.00127175726254755,0.000627179019585995],[2.64391179687404e-15,3.9541130468617e-13,2.62883958512948e-11,7.7138893299159e-10,1.00711123737439e-08,6.30780920826172e-08,2.60459769781679e-07,1.17091404010268e-06,6.4223070519356e-06,3.97967694763019e-05,0.000174215228431157,0.000446258062984927,0.000814092354721191,0.00130921849945535,0.00179692553075494,0.00226454648764132,0.00301584866051295,0.00375738290644251,0.00357802995552679,0.00297445019445136,0.00294457288713906,0.00283089075172355,0.0021583243649575,0.00135174230237115,0.000771337061258896],[3.24366421611113e-17,5.21889830627297e-15,3.66261116001612e-13,1.11802269469686e-11,1.51925192276937e-10,1.06387026102579e-09,6.36499481194371e-09,5.37393801216153e-08,6.26938428398947e-07,5.9186361834799e-06,3.15424960479865e-05,0.000106252868653342,0.000290580117601996,0.000594097895044633,0.000792568935307815,0.000911488869476369,0.00138859630454462,0.00218731685646112,0.00253650669490231,0.00242392570421794,0.00236857341243181,0.00215261271339804,0.00156971878699431,0.000941578982141071,0.000523704456941824],[1.77496084760789e-19,2.98017455269471e-17,2.15353823268818e-15,6.72986252069613e-14,9.5841827714638e-13,8.31817709020049e-12,9.48277279362666e-11,2.00764576576656e-09,4.09553751219711e-08,4.73477066852972e-07,3.22738879543151e-06,1.7465084478523e-05,7.23946973540746e-05,0.00016994294290451,0.000214822946380703,0.000231181651212602,0.000452851452217872,0.000948924751016775,0.0013719530795912,0.00148943716287497,0.00136615553591948,0.00110112684027814,0.000788423484786217,0.000476015173205125,0.000222530974917274],[4.13217336909082e-22,7.09136854244541e-20,5.20370656667621e-18,1.65936657299091e-16,2.58572826409946e-15,3.61911681416909e-14,1.21396277913803e-12,5.29574797595419e-11,1.35383339281867e-09,1.92945613242329e-08,2.11667637450606e-07,1.90235019969928e-06,9.79540822053264e-06,2.39196104159438e-05,2.89239619691129e-05,3.35883313869489e-05,0.00010049590353559,0.000290540824228266,0.000547550731260621,0.000699049686457391,0.000616720905553448,0.000439462383578763,0.000362923140733237,0.000270104584704502,0.000113152087049296]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
]

---

### 1. Joint distributions

#### 1.2. Covariance 

&lt;ul&gt;
  &lt;li&gt;When describing a &lt;b&gt;single distribution&lt;/b&gt;, we're interested in its &lt;b&gt;spread&lt;/b&gt; and &lt;b&gt;central tendency&lt;/b&gt;&lt;/li&gt;
  &lt;li&gt;When describing a &lt;b&gt;joint distribution&lt;/b&gt;, we're interested in the &lt;b&gt;relationship&lt;/b&gt; between the two variables&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;This can be characterized by the &lt;b&gt;&lt;i&gt;covariance&lt;/i&gt;&lt;/b&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
 
--

$$ \text{Cov}(x, y) = \frac{1}{N}\sum_{i=1}^{N}(x_i − \bar{x})(y_i − \bar{y}) $$

--

.pull-left[
&lt;p style = "margin-bottom: -.5cm;"&gt;&lt;/p&gt;
&lt;img src="slides_files/figure-html/unnamed-chunk-32-1.png" width="97%" style="display: block; margin: auto;" /&gt;
]

.pull-right[
&lt;p style = "margin-bottom: 1.25cm;"&gt;&lt;/p&gt;
&lt;center&gt;&lt;i&gt;If &lt;b&gt;y&lt;/b&gt; tends to be &lt;b&gt;large&lt;/b&gt; relative to its mean when &lt;b&gt;x&lt;/b&gt; is &lt;b&gt;large&lt;/b&gt; relative to its mean, their &lt;b&gt;covariance&lt;/b&gt; is &lt;b&gt;positive&lt;/b&gt;&lt;/i&gt;&lt;/center&gt;

&lt;p style = "margin-bottom: 1.25cm;"&gt;&lt;/p&gt;
&lt;center&gt;&lt;i&gt;Conversely, if &lt;b&gt;one&lt;/b&gt; tends to be &lt;b&gt;large&lt;/b&gt; when the &lt;b&gt;other&lt;/b&gt; tends to be &lt;b&gt;low&lt;/b&gt;, the &lt;b&gt;covariance&lt;/b&gt; is &lt;b&gt;negative&lt;/b&gt;&lt;/i&gt;&lt;/center&gt;
]


---

### 1. Joint distributions

#### 1.2. Covariance 

&lt;img src="slides_files/figure-html/unnamed-chunk-33-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

### 1. Joint distributions

#### 1.2. Covariance 

`$$\begin{align}
    \text{Cov}(X, a) = &amp; 0\\[1.5em]
    \text{Cov}(X, X) = &amp; \text{Var}(X)\\[1.5em]
    \text{Cov}(X, Y) = &amp; \text{Cov}(Y, X)\\[1.5em]
    \text{Cov}(aX, bY) = &amp; ab\text{Cov}(X, Y)\\[1.5em]
    \text{Cov}(X + a, Y + b) = &amp; \text{Cov}(X, Y)\\[1.5em]
    \text{Cov}(aX + bY, cW + dZ) = &amp; ac\text{Cov}(X, W) +   ad\text{Cov}(X, Z) + \\
    &amp; bc\text{Cov}(Y, W) +  bd\text{Cov}(Y, Z) 
\end{align}$$`
---

### 1. Joint distributions

#### 1.3. Correlation

&lt;ul&gt;
  &lt;li&gt;One disadvantage of the &lt;b&gt;covariance&lt;/b&gt; is that is it &lt;b&gt;not standardized&lt;/b&gt;&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;You &lt;b&gt;cannot&lt;/b&gt; directly &lt;b&gt;compare&lt;/b&gt; the covariance of two pairs of completely different variables&lt;/li&gt;
    &lt;li&gt;Given distance variables will have a larger covariance in centimeters than in meters&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom: 1cm;"&gt;&lt;/p&gt;

--
 
&lt;center&gt;&amp;#10140; Theoretically the &lt;b&gt;covariance&lt;/b&gt; can take &lt;b&gt;values&lt;/b&gt; from \(-\infty\) to \(+\infty\)&lt;/center&gt;

&lt;p style = "margin-bottom: 1.5cm;"&gt;&lt;/p&gt;

--

&lt;ul&gt;
  &lt;li&gt;To &lt;b&gt;net out&lt;/b&gt; the covariance from the &lt;b&gt;unit&lt;/b&gt; of the data, we can &lt;b&gt;divide&lt;/b&gt; it by \(\text{SD}(x)\times\text{SD}(y)\)&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;We call this &lt;b&gt;standardized&lt;/b&gt; measure the &lt;b&gt;correlation&lt;/b&gt;&lt;/li&gt;
    &lt;li&gt;Correlations coefficients are &lt;b&gt;comparable&lt;/b&gt; because they are independent from the unit of the data&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

--

`$$\text{Corr}(x, y) = \frac{\text{Cov}(x, y)}{\text{SD}(x)\times\text{SD}(y)}$$`

&lt;p style = "margin-bottom: 1cm;"&gt;&lt;/p&gt;

--

&lt;center&gt;&amp;#10140; The &lt;b&gt;correlation&lt;/b&gt; coefficient is bounded between &lt;b&gt;values&lt;/b&gt; from \(-1\) to \(1\)&lt;/center&gt;

---

### 1. Joint distributions

#### 1.3. Correlation

&lt;img src="slides_files/figure-html/unnamed-chunk-34-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

### 1. Joint distributions

&lt;center&gt;&lt;i&gt;&lt;b&gt;&amp;#10140; But a same correlation can hide very different relationships&lt;/b&gt;&lt;/i&gt;&lt;/center&gt;

&lt;img src="slides_files/figure-html/unnamed-chunk-35-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

### 1. Joint distributions

&lt;center&gt;&lt;i&gt;&lt;b&gt;&amp;#10140; Covariance and correlation in R&lt;/b&gt;&lt;/i&gt;&lt;/center&gt;



```r
x &lt;- c(50, 70, 60, 80, 60)
y &lt;- c(10, 30, 20, 30, 40)
```

--

&lt;p style = "margin-bottom:1.5cm;"&gt;

* The &lt;b&gt;covariance&lt;/b&gt; can be obtain with the function `cov()`


```r
cov(x, y)
```

```
## [1] 70
```

&lt;p style = "margin-bottom:1.5cm;"&gt;

--

* The &lt;b&gt;correlation&lt;/b&gt; can be obtain with the function `cor()`


```r
cor(x, y)
```

```
## [1] 0.5384615
```

---

&lt;h3&gt;Overview&lt;/h3&gt;

&lt;p style = "margin-bottom:3cm;"&gt;&lt;/p&gt;

.pull-left[

&lt;ul style = "margin-left:1.5cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;1. Joint distributions &amp;#10004;&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;1.1. Definition&lt;/li&gt;
    &lt;li&gt;1.2. Covariance&lt;/li&gt;
    &lt;li&gt;1.3. Correlation&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

&lt;ul style = "margin-left:1.5cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;2. Univariate regressions&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;2.1. Introduction to regressions&lt;/li&gt;
    &lt;li&gt;2.2. Coefficients estimation&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

]

.pull-right[

&lt;ul style = "margin-left:-1cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;3. Binary variables&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;3.1. Binary dependent variables&lt;/li&gt;
    &lt;li&gt;3.2. Binary independent variables&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
 
&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

&lt;ul style = "margin-left:-1cm;list-style: none"&gt;&lt;li&gt;&lt;b&gt;4. Wrap up!&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;
]

---

&lt;h3&gt;Overview&lt;/h3&gt;


&lt;p style = "margin-bottom:3cm;"&gt;&lt;/p&gt;

.pull-left[

&lt;ul style = "margin-left:1.5cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;1. Joint distributions &amp;#10004;&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;1.1. Definition&lt;/li&gt;
    &lt;li&gt;1.2. Covariance&lt;/li&gt;
    &lt;li&gt;1.3. Correlation&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

&lt;ul style = "margin-left:1.5cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;2. Univariate regressions&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;2.1. Introduction to regressions&lt;/li&gt;
    &lt;li&gt;2.2. Coefficients estimation&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

]


---

### 2. Univariate regressions

#### 2.1. Introduction to regressions

.pull-left[

 * Consider the following dataset
 

```r
ggcurve &lt;- read.csv("ggcurve.csv")
kable(head(ggcurve, 5), "First 5 rows")
```

&lt;table class="table table-hover table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;"&gt;
&lt;caption&gt;First 5 rows&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; ige &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; gini &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Denmark &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.15 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.38 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Norway &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.17 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.33 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Finland &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.38 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Canada &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.19 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.46 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Australia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.26 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.44 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.pull-right[
  
  &lt;p style = "margin-bottom:2cm;"&gt;&lt;/p&gt;
  The data contains &lt;b&gt;2 variables&lt;/b&gt; at the &lt;b&gt;country level&lt;/b&gt;:
  &lt;p style = "margin-bottom:1cm;"&gt;
  &lt;ul style = "margin-left:-.5cm;list-style: none"&gt;
    &lt;li&gt;1. &lt;b&gt;IGE:&lt;/b&gt; Intergenerational elasticity, which captures&lt;/i&gt;
  &lt;/ul&gt;
  
  &lt;p style = "margin-left:2.38cm; margin-top:-.5cm"&gt;the % average increase in child income for&lt;/p&gt;
  &lt;p style = "margin-left:2.38cm; margin-top:-.5cm"&gt;a 1% increase in parental income&lt;/p&gt;
  
  &lt;p style = "margin-bottom:1.5cm;"&gt;
  
  &lt;ul style = "margin-left:-.5cm;list-style: none"&gt;
    &lt;li&gt;2. &lt;b&gt;Gini:&lt;/b&gt; Gini index of income inequality between &lt;/i&gt;
  &lt;/ul&gt;
  
  &lt;p style = "margin-left:2.53cm; margin-top:-.5cm"&gt;0: everybody has the same income&lt;/p&gt;
  &lt;p style = "margin-left:2.53cm; margin-top:-.5cm"&gt;1: a single individual has all the income&lt;/p&gt;
  
]


---

### 2. Univariate regressions

#### 2.1. Introduction to regressions

 * To investigate the **relationship** between these two variables we can start with a **scatterplot**

--


```r
ggplot(ggcurve , aes(x = gini, y = ige, label = country)) + geom_text()
```
&lt;img src="slides_files/figure-html/unnamed-chunk-41-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---

### 2. Univariate regressions

#### 2.1. Introduction to regressions

&lt;ul&gt;
  &lt;li&gt;We see that the two variables are &lt;b&gt;positively correlated&lt;/b&gt; with each other:&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;When &lt;b&gt;one&lt;/b&gt; tends to be &lt;b&gt;high&lt;/b&gt; relative to its mean, &lt;b&gt;the other as well&lt;/b&gt;&lt;/li&gt;
    &lt;li&gt;When &lt;b&gt;one&lt;/b&gt; tends to be &lt;b&gt;low&lt;/b&gt; relative to its mean, &lt;b&gt;the other as well&lt;/b&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
  
--

&lt;p style = "margin-bottom:1cm;"&gt;


```r
cor(ggcurve$gini, ggcurve$ige)
```

```
## [1] 0.6517277
```
&lt;p style = "margin-bottom:1cm;"&gt;

&lt;ul&gt;
  &lt;li&gt;The &lt;b&gt;correlation&lt;/b&gt; coefficient is equal to &lt;b&gt;.65&lt;/b&gt;&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;Remember that the correlation can take values from -1 to 1&lt;/li&gt;
    &lt;li&gt;Here the correlation is indeed &lt;b&gt;positive&lt;/b&gt; and &lt;b&gt;fairly strong&lt;/b&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1cm;"&gt;

--

&lt;ul&gt;
  &lt;li&gt;But how useful is this for real-life applications? We may want more &lt;b&gt;practical&lt;/b&gt; information:&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;Like by how much \(y\) is &lt;b&gt;expected&lt;/b&gt; to &lt;b&gt;increas&lt;/b&gt;e for a given change in \(x\)&lt;/li&gt;
    &lt;li&gt;This is of particular interest for economists and &lt;b&gt;policy&lt;/b&gt; makers&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

---

&lt;style&gt; .left-column {width: 70%;} .right-column {width: 30%;} &lt;/style&gt;

### 2. Univariate regressions

#### 2.1. Introduction to regressions

 * Consider these two relationships :

.left-column[

&lt;img src="slides_files/figure-html/unnamed-chunk-43-1.png" width="90%" style="display: block; margin: auto auto auto 0;" /&gt;

]

.right-column[

&lt;p style = "margin-bottom:2.5cm;"&gt;
 
&amp;#10140; One is less noisy but flatter
 
&lt;p style = "margin-bottom:.5cm;"&gt;
 
&amp;#10140; One is noisier but steeper

&lt;p style = "margin-bottom:1.5cm;"&gt;
 
&lt;h4&gt;Both have a correlation of .75&lt;/h4&gt;
 
]

---

### 2. Univariate regressions

#### 2.1. Introduction to regressions

 * Consider these two relationships :

.left-column[

&lt;img src="slides_files/figure-html/unnamed-chunk-44-1.png" width="90%" style="display: block; margin: auto auto auto 0;" /&gt;

]

.right-column[
&lt;p style = "margin-bottom:3cm;"&gt;
&lt;center&gt;&lt;b&gt;&lt;i&gt;But a given increase in \(x\)&lt;/i&gt;&lt;/b&gt;&lt;/center&gt;
&lt;center&gt;&lt;b&gt;&lt;i&gt;is not associated with&lt;/i&gt;&lt;/b&gt;&lt;/center&gt;
&lt;center&gt;&lt;b&gt;&lt;i&gt;a same increase in \(y\)!&lt;/i&gt;&lt;/b&gt;&lt;/center&gt;
]

---

### 2. Univariate regressions

#### 2.1. Introduction to regressions

&lt;ul&gt;
  &lt;li&gt;Knowing that income inequality is &lt;b&gt;negatively correlated&lt;/b&gt; with intergenerational mobility is one thing&lt;/li&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.25cm;"&gt;

--

&lt;ul&gt;
  &lt;li&gt;But how much more intergenerational mobility could we expect for a given reduction in inequality?&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;We need to know to characterize the &lt;b&gt;&lt;i&gt;"steepness"&lt;/i&gt;&lt;/b&gt; of the relationship!&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.25cm;"&gt;

--

&lt;ul&gt;
  &lt;li&gt;It is usually the &lt;b&gt;type of questions&lt;/b&gt; we're interested in:&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;i&gt;How much more should I expect to earn for an additional year of education?&lt;/i&gt;&lt;/li&gt;
    &lt;li&gt;&lt;i&gt;By how many years would life expectancy be expected to decrease for a given increase in air pollution?&lt;/i&gt;&lt;/li&gt;
    &lt;li&gt;&lt;i&gt;By how much would test scores increase for a given decrease in the number of students per teacher?&lt;/i&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.25cm;"&gt;

--

 * And once again, this is typically what is of interest for &lt;b&gt;policymakers&lt;/b&gt;

&lt;p style = "margin-bottom:1.25cm;"&gt;

--

&lt;center&gt;&lt;h4&gt;&lt;i&gt;&amp;#10140; But how to compute this expected change in \(y\) for a given change of \(x\)?&lt;/i&gt;&lt;/h4&gt;&lt;/center&gt;

---

### 2. Univariate regressions

#### 2.2. Coefficients estimation

&lt;ul&gt;
  &lt;li&gt;The idea is to find the &lt;b&gt;line that fits the data&lt;/b&gt; the best&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;Such that its &lt;b&gt;slope&lt;/b&gt; can indicate how we &lt;b&gt;expect y to change&lt;/b&gt; if we &lt;b&gt;increase x by 1&lt;/b&gt; unit&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
 
--

&lt;img src="slides_files/figure-html/unnamed-chunk-45-1.png" width="65%" style="display: block; margin: auto;" /&gt;

---

### 2. Univariate regressions

#### 2.2. Coefficients estimation

 * But how do we &lt;b&gt;find that line?&lt;/b&gt;
 
--
 
&lt;img src="slides_files/figure-html/unnamed-chunk-46-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

### 2. Univariate regressions

#### 2.2. Coefficients estimation

 * We try to &lt;b&gt;minimize the distance&lt;/b&gt; between each point and our line
 
&lt;img src="slides_files/figure-html/unnamed-chunk-47-1.png" width="100%" style="display: block; margin: auto;" /&gt;

---

### 2. Univariate regressions

#### 2.2. Coefficients estimation
 
.pull-left[

&lt;p style = "margin-bottom:1cm;"&gt;&lt;/p&gt;

Take for instance the 20&lt;sup&gt;th&lt;/sup&gt; observation: Peru

&lt;img src="slides_files/figure-html/unnamed-chunk-48-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

--

.pull-right[

And consider the following **notations**:

  * We denote `\(y_i\)` the ige of the `\(i^{\text{th}}\)` country
  
  * We denote `\(x_i\)` the gini of the `\(i^{\text{th}}\)` country
  
  * We denote `\(\widehat{y_i}\)` the value of the `\(y\)` coordinate of our line for `\(x = x_i\)`

&lt;p style = "margin-bottom:1.25cm;"&gt;&lt;/p&gt;
  
&lt;center&gt;&amp;#10140; The distance between the \(i^{\text{th}}\) y value and the line is \(y_i - \widehat{y_i}\)&lt;/center&gt;

&lt;p style = "margin-bottom:1.25cm;"&gt;&lt;/p&gt;

 * We label that distance `\(\widehat{\varepsilon_i}\)`

]

---

### 2. Univariate regressions

#### 2.2. Coefficients estimation

.pull-left[

&lt;p style = "margin-bottom:2.375cm;"&gt;&lt;/p&gt;

&lt;img src="slides_files/figure-html/unnamed-chunk-49-1.png" width="100%" style="display: block; margin: auto;" /&gt;

]

.pull-right[

 * `\(\widehat{\varepsilon_i}\)` being the distance between a point `\(y_i\)` and its corresponding value on the line `\(\widehat{y_i}\)`, we can write:

`$$y_i = \widehat{y_i} + \widehat{\varepsilon_i}$$`

&lt;p style = "margin-bottom:1cm;"&gt;&lt;/p&gt;

 * And because `\(\widehat{y_i}\)` is a **straight line**, it can be expressed as
 
`$$\widehat{y_i} = \hat{\alpha} + \hat{\beta}x_i$$`

&lt;p style = "margin-bottom:1cm;"&gt;&lt;/p&gt;

 * Where:
  * `\(\hat{\alpha}\)` is the **intercept**
  * `\(\hat{\beta}\)` is the **slope**
]

---

### 2. Univariate regressions

#### 2.2. Coefficients estimation

 * **Combining** these two **definitions** yields the equation:

`$$y_i = \hat{\alpha} + \hat{\beta}x_i + \widehat{\varepsilon_i} \begin{cases}  y_i = \widehat{y_i} + \widehat{\varepsilon_i}&amp; \text{Definition of distance}\\
\widehat{y_i} = \hat{\alpha} + \hat{\beta}x_i &amp; \text{Definition of the line}
\end{cases}$$`

--

&lt;p style = "margin-bottom:1.25cm;"&gt;&lt;/p&gt;

 * Depending on the values of `\(\hat{\alpha}\)` and `\(\hat{\beta}\)`, the value of every `\(\widehat{\varepsilon_i}\)` will change

--

&lt;p style = "margin-bottom:-.5cm;"&gt;&lt;/p&gt;

.left-column[
&lt;img src="slides_files/figure-html/unnamed-chunk-50-1.png" width="90%" style="display: block; margin: auto auto auto 0;" /&gt;

]

.right-column[

&lt;p style = "margin-bottom:-.75cm;"&gt;&lt;/p&gt;

**Attempt 1:** `\(\hat{\alpha}\)` is too high and `\(\hat{\beta}\)` is 
&lt;p style = "margin-left:2.97cm;margin-top:-.5cm;"&gt;too low &amp;#10140; \(\widehat{\varepsilon_i}\) are large&lt;/p&gt;
 
**Attempt 2:** `\(\hat{\alpha}\)` is too low and `\(\hat{\beta}\)` is 
&lt;p style = "margin-left:2.97cm;margin-top:-.5cm;"&gt;too high &amp;#10140; \(\widehat{\varepsilon_i}\) are large&lt;/p&gt;
 
**Attempt 3:** both `\(\hat{\alpha}\)` and `\(\hat{\beta}\)` seem 
&lt;p style = "margin-left:2.97cm;margin-top:-.5cm;"&gt;right &amp;#10140; \(\widehat{\varepsilon_i}\) are low&lt;/p&gt;

]

---

### 2. Univariate regressions

#### 2.2. Coefficients estimation

 * We want to find the values of `\(\hat{\alpha}\)` and `\(\hat{\beta}\)` that **minimize** the overall **distance** between the points and the line

--

`$$\min_{\hat{\alpha}, \hat{\beta}}\sum_{i=1}^{n}\widehat{\varepsilon_i}^2$$`
&lt;ul&gt;
  &lt;ul&gt;
    &lt;li&gt;Note that we square \(\widehat{\varepsilon_i}\) to avoid that its positive and negative values compensate&lt;/li&gt;
    &lt;li&gt;This method is what we call &lt;b&gt;Ordinary Least Squares (OLS)&lt;/b&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

--

 * To solve this **optimization problem**, we need to express `\(\widehat{\varepsilon_i}\)` it in terms of alpha `\(\hat{\alpha}\)` and `\(\hat{\beta}\)`

`$$y_i = \hat{\alpha} + \hat{\beta}x_i + \widehat{\varepsilon_i}$$` 
`$$\Longleftrightarrow$$`
`$$\widehat{\varepsilon_i} = y_i -\hat{\alpha} - \hat{\beta}x_i$$`

---

### 2. Univariate regressions

#### 2.2. Coefficients estimation

 * And our minimization problem writes

`$$\min_{\hat{\alpha}, \hat{\beta}}\sum_{i=1}^{n}(y_i -\hat{\alpha} - \hat{\beta}x_i)^2$$`

--

$$
`\begin{align}
\frac{\partial}{\partial\hat{\alpha}} = 0 &amp; \:\: \Longleftrightarrow \:\: -2\sum_{i=1}^n(y_i - \hat{\alpha} - \hat{\beta}x_i) = 0 \\
\frac{\partial}{\partial\hat{\beta}}  = 0 &amp; \:\: \Longleftrightarrow \:\: -2x_i\sum_{i=1}^n(y_i - \hat{\alpha} - \hat{\beta}x_i) = 0
\end{align}`
$$

&lt;p style = "margin-bottom:1cm;"&gt;&lt;/p&gt;

--

 * Rearranging the first equation yields
 
`$$\sum_{i=1}^ny_i - n\hat{\alpha} - \sum_{i=1}^n\hat{\beta}x_i = 0 \:\: \Longleftrightarrow \:\: \hat{\alpha} =\bar{y} - \hat{\beta}\bar{x}$$`

---

### 2. Univariate regressions

#### 2.2. Coefficients estimation

 * Replacing `\(\hat{\alpha}\)` in the second equation by its new expression writes

`$$-2\sum_{i=1}^n(y_i - \hat{\alpha} - \hat{\beta}x_i) = 0  \:\: \Longleftrightarrow \:\: -2\sum_{i=1}^n\left[y_i - (\bar{y} - \hat{\beta}\bar{x}) - \hat{\beta}x_i\right] = 0$$`

--

&lt;p style = "margin-bottom:1.25cm;"&gt;&lt;/p&gt;

 * And by rearranging the terms we obtain
 
`$$\hat{\beta} = \frac{\sum_{i = 1}^n(x_i-\bar{x})(y_i-\bar{y})}{\sum_{i = 1}^n(x_i-\bar{x})^2}$$`

--

&lt;p style = "margin-bottom:1.25cm;"&gt;&lt;/p&gt;

  * Notice that multiplying the nominator and the denominator by `\(1/n\)` yields:
  
`$$\hat{\beta} = \frac{\text{Cov}(x_i, y_i)}{\text{Var}(x_i)} \:\:\:\:\:\:\:\:\: ; \:\:\:\:\:\:\:\:\: \hat{\alpha} = \bar{y} - \frac{\text{Cov}(x_i, y_i)}{\text{Var}(x_i)} \times\bar{x}$$`

---
class: inverse, hide-logo

### Practice

#### 1) Import `ggcurve.csv` and compute the `\(\hat{\alpha}\)` and `\(\hat{\beta}\)` coefficients of that equation:
 
`$$\text{gini}_i = \hat{\alpha} + \hat{\beta}\times\text{IGE}_i + \widehat{\varepsilon_i}$$`

--

&lt;p style = "margin-bottom:1cm;"&gt;&lt;/p&gt;

#### 2) Create a new variable in the dataset for `\(\widehat{\text{gini}}\)`

--

&lt;p style = "margin-bottom:1cm;"&gt;&lt;/p&gt;

#### 3) Plot your results (scatter plot + line)

*Hints: You can use different y variables for different geometries by specifying the mapping within the geometry function:*

&lt;p style = "margin-bottom:-.5cm;"&gt;&lt;/p&gt;
&lt;center&gt;&lt;i&gt;geom_point(aes(y = y))&lt;/i&gt;&lt;/center&gt;
&lt;p style = "margin-bottom:1cm;"&gt;&lt;/p&gt;

`$$\hat{\beta} = \frac{\text{Cov}(x_i, y_i)}{\text{Var}(x_i)} \:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\:\: \hat{\alpha} = \bar{y} - \frac{\text{Cov}(x_i, y_i)}{\text{Var}(x_i)} \times\bar{x}$$`

--

&lt;p style = "margin-bottom:1.25cm;"&gt;&lt;/p&gt;

&lt;center&gt;&lt;h3&gt;&lt;i&gt;You've got 10 minutes!&lt;/i&gt;&lt;/h3&gt;&lt;/center&gt;

<div class="countdown" id="timer_5340ef29" data-update-every="1" data-start-immediately="true" tabindex="0" style="top:0;right:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">10</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>

---
class: inverse, hide-logo

### Solution

#### 1) Import `ggcurve.csv` and compute the `\(\hat{\alpha}\)` and `\(\hat{\beta}\)` coefficients of that equation:

--


```r
# Read the data
ggcurve &lt;- read.csv("ggcurve.csv")
# Compute beta
beta &lt;- cov(ggcurve$gini, ggcurve$ige) / var(ggcurve$gini)
# Compute alpha
alpha &lt;- mean(ggcurve$ige) - (beta * mean(ggcurve$gini))
```

--


```r
c(alpha, beta)
```

```
## [1] -0.09129311  1.01546204
```

--

#### 2) Create a new variable in the dataset for `\(\widehat{\text{gini}}\)`

--


```r
ggcurve &lt;- ggcurve %&gt;%
  mutate(fit = alpha + beta * gini)
```

---
class: inverse, hide-logo

### Solution

#### 3) Plot your results (scatter plot + line)

--


```r
ggplot(ggcurve, aes(x = gini)) + 
  geom_point(aes(y = ige)) + geom_line(aes(y = fit))
```
 
--

&lt;img src="slides_files/figure-html/unnamed-chunk-55-1.png" width="57%" style="display: block; margin: auto;" /&gt;

---

### 2. Univariate regressions

#### 2.2. Coefficients estimation

 * As usual there are &lt;b&gt;functions&lt;/b&gt; to do that &lt;b&gt;in R&lt;/b&gt;
 
--
 
.pull-left[

&lt;ul&gt;
  &lt;li&gt;&lt;b&gt;lm()&lt;/b&gt; to estimate regression coefficients&lt;/li&gt;
  &lt;li&gt;It has two main &lt;b&gt;arguments:&lt;/b&gt;&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;b&gt;Formula:&lt;/b&gt; written as &lt;b&gt;y ~ x&lt;/b&gt;&lt;/li&gt;
    &lt;li&gt;&lt;b&gt;Data:&lt;/b&gt; where y and x are&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;


```r
lm(ige ~ gini, ggcurve)
```

```
## 
## Call:
## lm(formula = ige ~ gini, data = ggcurve)
## 
## Coefficients:
## (Intercept)         gini  
##    -0.09129      1.01546
```

]

--

.pull-right[

&lt;ul&gt;
  &lt;li&gt;&lt;b&gt;geom_smooth()&lt;/b&gt; to plot the fit&lt;/li&gt;
&lt;/ul&gt;


```r
ggplot(ggcurve, aes(x = gini, y = ige)) + 
  geom_point() + 
  geom_smooth(method = "lm", formula = y ~ x)
```

&lt;img src="slides_files/figure-html/unnamed-chunk-57-1.png" width="80%" style="display: block; margin: auto;" /&gt;

]

---
class: inverse, hide-logo

&lt;center&gt;&lt;h3&gt; Vocabulary &lt;/h3&gt;&lt;/center&gt;

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

 * This equation we're working on is called a &lt;b&gt;regression model&lt;/b&gt;
 
`$$y_i = \hat{\alpha} + \hat{\beta}x_i + \widehat{\varepsilon_i}$$` 

--

&lt;ul&gt;
  &lt;ul&gt;
  &lt;li&gt; We say that we &lt;b&gt;regress \(y\) on \(x\)&lt;/b&gt; to find the coefficients \(\hat{\alpha}\) and \(\hat{\beta}\) that characterize the regression line&lt;/li&gt;
  &lt;li&gt; We often call \(\hat{\alpha}\) and \(\hat{\beta}\) &lt;b&gt;parameters&lt;/b&gt; of the regression because we tune them to fit our model to the data&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.25cm;"&gt;&lt;/p&gt;

--

&lt;ul&gt;
  &lt;li&gt;We also have different names for the \(x\) and \(y\) variables&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt; \(y\) is called the &lt;b&gt;dependent&lt;/b&gt; or &lt;b&gt;explained&lt;/b&gt; variable
    &lt;li&gt; \(x\) is called the &lt;b&gt;independent&lt;/b&gt; or &lt;b&gt;explanatory&lt;/b&gt; variable
  &lt;/ul&gt;
&lt;/ul&gt;


--

&lt;p style = "margin-bottom:1.25cm;"&gt;&lt;/p&gt;

 * We call `\(\widehat{\varepsilon_i}\)` the &lt;b&gt;residuals&lt;/b&gt; because it is what is left after we fitted the data the best we could

--

&lt;p style = "margin-bottom:1.25cm;"&gt;&lt;/p&gt;

 * And `\(\hat{y_i} = \hat{\alpha} + \hat{\beta}x_i\)`, i.e., the value on the regression line for a given `\(x_i\)` are called the &lt;b&gt;fitted values&lt;/b&gt;

---

&lt;h3&gt;Overview&lt;/h3&gt;

&lt;p style = "margin-bottom:3cm;"&gt;&lt;/p&gt;

.pull-left[

&lt;ul style = "margin-left:1.5cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;1. Joint distributions &amp;#10004;&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;1.1. Definition&lt;/li&gt;
    &lt;li&gt;1.2. Covariance&lt;/li&gt;
    &lt;li&gt;1.3. Correlation&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

&lt;ul style = "margin-left:1.5cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;2. Univariate regressions &amp;#10004;&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;2.1. Introduction to regressions&lt;/li&gt;
    &lt;li&gt;2.2. Coefficients estimation&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

]

.pull-right[

&lt;ul style = "margin-left:-1cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;3. Binary variables&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;3.1. Binary dependent variables&lt;/li&gt;
    &lt;li&gt;3.2. Binary independent variables&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
 
&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

&lt;ul style = "margin-left:-1cm;list-style: none"&gt;&lt;li&gt;&lt;b&gt;4. Wrap up!&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;
]

---

&lt;h3&gt;Overview&lt;/h3&gt;

&lt;p style = "margin-bottom:3cm;"&gt;&lt;/p&gt;

.pull-left[

&lt;ul style = "margin-left:1.5cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;1. Joint distributions &amp;#10004;&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;1.1. Definition&lt;/li&gt;
    &lt;li&gt;1.2. Covariance&lt;/li&gt;
    &lt;li&gt;1.3. Correlation&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

&lt;ul style = "margin-left:1.5cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;2. Univariate regressions &amp;#10004;&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;2.1. Introduction to regressions&lt;/li&gt;
    &lt;li&gt;2.2. Coefficients estimation&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

]

.pull-right[

&lt;ul style = "margin-left:-1cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;3. Binary variables&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;3.1. Binary dependent variables&lt;/li&gt;
    &lt;li&gt;3.2. Binary independent variables&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
 
]

---

### 3. Binary variables

#### 3.1. Binary dependent variables

&lt;ul&gt;
  &lt;li&gt;&lt;b&gt;So far&lt;/b&gt; we've considered only &lt;b&gt;continuous variables&lt;/b&gt; in our regression models&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;But what if our &lt;b&gt;dependent&lt;/b&gt; variable is &lt;b&gt;discrete?&lt;/b&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

--

&lt;ul&gt;
  &lt;li&gt;Consider that we have data on candidates to a job:&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;Their &lt;i&gt;Baccalauréat&lt;/i&gt; grade (/20) &lt;/li&gt;
    &lt;li&gt;Whether they got accepted&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
  
--

&lt;p style = "margin-bottom:1.25cm;"&gt;

&lt;img src="slides_files/figure-html/unnamed-chunk-58-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---

### 3. Binary variables

#### 3.1. Binary dependent variables

&lt;ul&gt;
  &lt;li&gt;Even if the &lt;b&gt;outcome variable&lt;/b&gt; is binary we can regress it on the grade variable&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;We can convert it into a &lt;b&gt;dummy&lt;/b&gt; variable, a variable taking either the value &lt;b&gt;0 or 1&lt;/b&gt;&lt;/li&gt;
    &lt;li&gt;Here consider a dummy variable taking the value 1 if the person was accepted&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

--

&lt;p style = "margin-bottom:1.25cm;"&gt;

`$$1\{y_i = \text{Accepted}\} = \hat{\alpha} + \hat{\beta} \times \text{Grade}_i + \hat{\varepsilon_i}$$`

&lt;p style = "margin-bottom:1cm;"&gt;

&lt;style&gt; .left-column {width: 65%;} .right-column {width: 35%;} &lt;/style&gt;

.left-column[

&lt;img src="slides_files/figure-html/unnamed-chunk-59-1.png" width="85%" style="display: block; margin: auto;" /&gt;

]

--

.right-column[

&lt;p style = "margin-bottom:2cm;"&gt;

&lt;center&gt;&lt;h4&gt;&lt;i&gt; &amp;#10140; How would you interpret the beta coefficient from this regression?&lt;/i&gt;&lt;/h4&gt;&lt;/center&gt;

]

---

### 3. Binary variables

#### 3.1. Binary dependent variables

&lt;ul&gt;
  &lt;li&gt;The &lt;b&gt;fitted values&lt;/b&gt; can be viewed as the &lt;b&gt;probability&lt;/b&gt; to be accepted for a given grade&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;\(\hat{\beta}\) is thus by how much this probability would vary on expectation for a 1 point increase in the grade&lt;/li&gt;
    &lt;li&gt;That's why we call OLS regression models with a binary outcome &lt;b&gt;Linear &lt;i&gt;Probability&lt;/i&gt; Models&lt;/b&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.35cm;"&gt;&lt;/p&gt;

&lt;img src="slides_files/figure-html/unnamed-chunk-60-1.png" width="70%" style="display: block; margin: auto;" /&gt;

---

### 3. Binary variables

#### 3.1. Binary dependent variables

&lt;ul&gt;
  &lt;li&gt;But what kind of &lt;b&gt;problems&lt;/b&gt; could we encounter with &lt;b&gt;such models?&lt;/b&gt;&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;What would be the \(\hat{\alpha}\) coefficient here?&lt;/li&gt;
    &lt;li&gt;And what's the probability to be accepted for a grade of 18?&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

&lt;img src="slides_files/figure-html/unnamed-chunk-61-1.png" width="70%" style="display: block; margin: auto;" /&gt;

---

### 3. Binary variables

#### 3.1. Binary dependent variables

&lt;ul&gt;
  &lt;li&gt;With an &lt;b&gt;LPM&lt;/b&gt; you can end up with &lt;b&gt;&lt;i&gt;"probabilities"&lt;/i&gt;&lt;/b&gt; that are &lt;b&gt;lower than 0&lt;/b&gt; and &lt;b&gt;greater than 1&lt;/b&gt;&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;b&gt;Interpretation&lt;/b&gt; is only &lt;b&gt;valid&lt;/b&gt; for values of x sufficiently &lt;b&gt;close to the mean&lt;/b&gt;&lt;/li&gt;
    &lt;li&gt;Keep that in mind and be &lt;b&gt;careful&lt;/b&gt; when interpreting the results of an LPM&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

&lt;img src="slides_files/figure-html/unnamed-chunk-62-1.png" width="70%" style="display: block; margin: auto;" /&gt;

---

### 3. Binary variables

#### 3.2. Binary independent variables

&lt;ul&gt;
  &lt;li&gt;Now consider that we have individual &lt;b&gt;data&lt;/b&gt; containing&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;The &lt;b&gt;sex&lt;/b&gt;&lt;/li&gt;
    &lt;li&gt;The &lt;b&gt;height&lt;/b&gt; (centimeters)&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

--

&lt;p style = "margin-bottom:1.5cm;"&gt;
 
&lt;ul&gt;
  &lt;li&gt;So the situation is different&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;We used to have a &lt;b&gt;binary dependent variable:&lt;/b&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

`$$1\{y_i = \text{Accepted}\} = \hat{\alpha} + \hat{\beta} \times \text{Grade}_i + \hat{\varepsilon_i}$$`
 
&lt;ul&gt;
  &lt;ul&gt;
    &lt;li&gt;We now have a &lt;b&gt;binary independent variable:&lt;/b&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
 
`$$\text{Height}_i = \hat{\alpha} + \hat{\beta} \times 1\{\text{Sex}_i = \text{Male}\} + \hat{\varepsilon_i}$$`

--

&lt;p style = "margin-bottom:1.25cm;"&gt;

&lt;center&gt;&lt;h4&gt;&lt;i&gt; &amp;#10140; How would you interpret the coefficient \(\hat{\beta}\) from this regression?&lt;/i&gt;&lt;/h4&gt;&lt;/center&gt;

---

### 3. Binary variables

#### 3.2. Binary independent variables

&lt;ul&gt;
  &lt;li&gt;If the sex variable was &lt;b&gt;continuous&lt;/b&gt; it would be the expected increase in height for a &lt;b&gt;&lt;i&gt;"1 unit increase"&lt;/i&gt;&lt;/b&gt; in sex&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;Here the &lt;b&gt;&lt;i&gt;"1 unit increase"&lt;/i&gt;&lt;/b&gt; is switching from 0 to 1, i.e. &lt;b&gt;from female to male&lt;/b&gt;&lt;/li&gt;
    &lt;li&gt;With that in mind, how would you interpret the coefficient \(\hat{\beta}\)?&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;img src="slides_files/figure-html/unnamed-chunk-63-1.png" width="50%" style="display: block; margin: auto;" /&gt;

---

### 3. Binary variables

#### 3.2. Binary independent variables

&lt;ul&gt;
  &lt;li&gt;If I replace the point geometry by the corresponding &lt;b&gt;boxplots&lt;/b&gt;&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;What this &lt;b&gt;&lt;i&gt;"1 unit increase"&lt;/i&gt;&lt;/b&gt; corresponds to should be &lt;b&gt;clearer&lt;/b&gt;&lt;/li&gt;
    &lt;li&gt;The coefficient \(\hat{\beta}\) is actually the &lt;b&gt;difference&lt;/b&gt; between the &lt;b&gt;average height&lt;/b&gt; for males and females&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;img src="slides_files/figure-html/unnamed-chunk-64-1.png" width="50%" style="display: block; margin: auto;" /&gt;

---

### 3. Binary variables

#### 3.2. Binary independent variables

.pull-left[

`\(\overline{\text{Height}_{\left[\text{Sex}_i = \text{Female}\right]}} = 165\)`  

`\(\overline{\text{Height}_{\left[\text{Sex}_i = \text{Male}\right]}} = 176\)`  

&lt;p style = "margin-bottom:1.5cm;"&gt;

`$$\text{Height}_i = \hat{\alpha} + \hat{\beta} \times 1\{\text{Sex}_i = \text{Male}\} + \hat{\varepsilon_i}$$`
`$$\hat{\alpha} = 165 \:\:\:\:\:\:\:\:\:\:\:\:\:\: \hat{\beta} = 11$$`

&lt;p style = "margin-bottom:1.5cm;"&gt;

`$$\text{Height}_i = \hat{\alpha} + \hat{\beta} \times 1\{\text{Sex}_i = \text{Female}\} + \hat{\varepsilon_i}$$`
`$$\hat{\alpha} = 176 \:\:\:\:\:\:\:\:\:\:\:\:\:\: \hat{\beta} = -11$$`

]
 
.pull-right[
&lt;p style = "margin-bottom:1cm;"&gt;
&lt;img src="slides_files/figure-html/unnamed-chunk-65-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]
 

---

### 3. Binary variables

#### 3.2. Binary independent variables

 * In terms of &lt;b&gt;fitted values:&lt;/b&gt;
 
`$$\text{Height}_i = \hat{\alpha} + \hat{\beta} \times 1\{\text{Sex}_i = \text{Male}\} + \hat{\varepsilon_i}$$`

--

 * We now have `\(\hat{\alpha}\)` and `\(\hat{\beta}\)`:
 
`$$\text{Height}_i = 165 + 11 \times 1\{\text{Sex}_i = \text{Male}\} + \hat{\varepsilon_i}$$`

--

 * The fitted values write:

`$$\widehat{\text{Height}_i} =  165 + 11 \times 1\{\text{Sex}_i = \text{Male}\}$$`

--

.pull-left[

 * When the dummy equals 0 *(females)*:
 
`$$\begin{align}
\widehat{\text{Height}_i} &amp; = 165 + 11 \times 0\\
&amp;= 165 =\overline{\text{Height}_{\left[\text{Sex}_i = \text{Female}\right]}}
\end{align}$$`

]

--

.pull-right[

 * When the dummy equals 1 *(males)*:
 
`$$\begin{align}\widehat{\text{Height}_i} &amp; = 165 + 11 \times 1\\
&amp;= 176 =\overline{\text{Height}_{\left[\text{Sex}_i = \text{Male}\right]}}\end{align}$$`

]

---

&lt;h3&gt;Overview&lt;/h3&gt;

&lt;p style = "margin-bottom:3cm;"&gt;&lt;/p&gt;

.pull-left[

&lt;ul style = "margin-left:1.5cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;1. Joint distributions &amp;#10004;&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;1.1. Definition&lt;/li&gt;
    &lt;li&gt;1.2. Covariance&lt;/li&gt;
    &lt;li&gt;1.3. Correlation&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

&lt;ul style = "margin-left:1.5cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;2. Univariate regressions &amp;#10004;&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;2.1. Introduction to regressions&lt;/li&gt;
    &lt;li&gt;2.2. Coefficients estimation&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

]

.pull-right[

&lt;ul style = "margin-left:-1cm;list-style: none"&gt;
  &lt;li&gt;&lt;b&gt;3. Binary variables &amp;#10004;&lt;/b&gt;&lt;/li&gt;
  &lt;ul style = "list-style: none"&gt;
    &lt;li&gt;3.1. Binary dependent variables&lt;/li&gt;
    &lt;li&gt;3.2. Binary independent variables&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
 
&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

&lt;ul style = "margin-left:-1cm;list-style: none"&gt;&lt;li&gt;&lt;b&gt;4. Wrap up!&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;
]

---

### 4. Wrap up!

#### 1. Joint distribution

&lt;center&gt;The &lt;b&gt;joint distribution&lt;/b&gt; shows the possible &lt;b&gt;values&lt;/b&gt; and associated &lt;b&gt;frequencies&lt;/b&gt; for &lt;b&gt;two variables&lt;/b&gt; simultaneously&lt;/center&gt;

--

.pull-left[
&lt;img src="slides_files/figure-html/unnamed-chunk-66-1.png" width="100%" style="display: block; margin: auto;" /&gt;
]

--

.pull-right[

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

<div id="htmlwidget-4d7151894c941a32a79b" style="width:100%;height:375px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4d7151894c941a32a79b">{"x":{"visdat":{"28ec320f7dc7":["function () ","plotlyVisDat"]},"cur_data":"28ec320f7dc7","attrs":{"28ec320f7dc7":{"x":[-0.0807095806719289,0.307916442595626,0.69654246586318,1.08516848913073,1.47379451239829,1.86242053566584,2.2510465589334,2.63967258220095,3.02829860546851,3.41692462873606,3.80555065200362,4.19417667527117,4.58280269853873,4.97142872180628,5.36005474507383,5.74868076834139,6.13730679160894,6.5259328148765,6.91455883814405,7.30318486141161,7.69181088467916,8.08043690794672,8.46906293121427,8.85768895448182,9.24631497774938],"y":[-3.30568873578819,-1.79530948768298,-0.284930239577762,1.22544900852745,2.73582825663267,4.24620750473788,5.7565867528431,7.26696600094831,8.77734524905353,10.2877244971587,11.798103745264,13.3084829933692,14.8188622414744,16.3292414895796,17.8396207376848,19.34999998579,20.8603792338952,22.3707584820005,23.8811377301057,25.3915169782109,26.9018962263161,28.4122754744213,29.9226547225265,31.4330339706318,32.943413218737],"z":[[0.00024508886410526,0.000167519136787181,7.23264479565564e-05,8.7790748227019e-05,0.000150997725375558,0.000145057695075036,9.33086576110266e-05,7.27038055999315e-05,5.89007062776598e-05,4.05050077072412e-05,2.03254513334412e-05,5.8175859371393e-06,9.62161967798373e-07,1.00138715757e-07,5.9047321191474e-09,1.66978438769237e-10,2.07912182555249e-12,1.11061078159493e-14,2.62688008037698e-17,4.21108910311574e-20,1.22275994895103e-22,2.99557108321877e-25,3.36498074091128e-28,1.63480594649313e-31,3.68029069171043e-35],[0.000190410558866371,0.000180769966980471,0.000169730037917858,0.000273290647847732,0.000425153163935444,0.00040179905960646,0.000293890135190469,0.000274346666737066,0.000240944593695991,0.000180748469593847,0.000102523178456552,3.7089468309811e-05,8.63883386991101e-06,1.17114843916792e-06,7.75852023639417e-08,2.28129983729178e-09,2.90193255183716e-11,1.74364445236043e-13,1.0132024417135e-15,9.88162929997035e-18,5.96240494831403e-20,1.59599285563772e-22,1.86490762513196e-25,1.03468995779599e-28,5.7335205694112e-32],[0.000181224135326733,0.000303372716416055,0.000400745385844619,0.000536235996145626,0.000681677337549412,0.000613676869725022,0.000491829972740464,0.000500209151714657,0.000444433674355811,0.000357268421874213,0.000251229939721038,0.000127959553539725,3.96005451822329e-05,6.13142050430614e-06,4.26875915763742e-07,1.31699768677606e-08,2.23003058960697e-10,5.09964757657508e-12,1.40563350966373e-13,2.02619820275674e-15,1.29348936095228e-17,3.67538915274733e-20,5.13840940171888e-23,6.86304609426317e-26,2.34241392076309e-28],[0.000225698174491013,0.000432569723507913,0.000643042298053052,0.000913275926088243,0.00113533247406491,0.000991090738817961,0.000702150094274123,0.000591419914263935,0.000470771664273875,0.000389692243468388,0.000358748393348194,0.00024119481142929,8.59257989334876e-05,1.43104009587808e-05,1.14626249200425e-06,6.53781160103376e-08,5.19988567903116e-09,3.50382055893124e-10,1.1824708937556e-11,1.80648394139002e-13,1.26990236409184e-15,4.60117523026591e-18,1.49116271513345e-20,9.91001181217751e-23,7.76507411368617e-25],[0.000150271307581504,0.00035064815848264,0.00073477812400342,0.00134026972969151,0.00183765430080911,0.00172973539719237,0.00127045372615812,0.00097102425296357,0.000716406026183231,0.000528865449746625,0.000454485572182241,0.000306394229123308,0.000119193545689801,2.77837237884181e-05,5.33272795104367e-06,1.05907533720786e-06,1.55192445734476e-07,1.19968992878276e-08,4.41142262610415e-10,7.85865025780023e-12,7.58856409719853e-14,5.96095624645547e-16,7.68679187838861e-18,1.09265062233149e-19,1.53606758845227e-21],[6.24119278458045e-05,0.000243053096183372,0.000762590282034262,0.00164814006513693,0.00242260012941292,0.00262283367237308,0.00250739309891553,0.00229981339092836,0.00181506147918392,0.00129208767202061,0.00095676971911064,0.000629774768070952,0.000317532452839975,0.000127584789555953,4.50138247631201e-05,1.2676627421307e-05,2.16602514531694e-06,1.92964916932064e-07,8.95062131770275e-09,2.34151019351187e-10,4.43667317668071e-12,1.0930849155116e-13,2.93116076767344e-15,6.99356275035407e-17,1.6168256192813e-18],[6.2626149361263e-05,0.000248121596339015,0.000778430450040387,0.00181255736075202,0.0029085085032159,0.00366813810757154,0.00434050157864386,0.00455395609434902,0.00387987994023496,0.00298336832540319,0.00237355416945188,0.00173028582598385,0.00100088165759343,0.000481560174887576,0.000212643352727932,7.34916098168515e-05,1.57612189425519e-05,1.93552905763632e-06,1.36342761413542e-07,6.20026428914048e-09,2.90065844144593e-10,1.48006873423392e-11,6.12151073007542e-13,2.55413007685167e-14,7.76317127314241e-16],[0.000121143279621856,0.000338251799187226,0.000760933741335707,0.00167268752404723,0.0029416523864437,0.00443713871599664,0.00617688655031233,0.00712671710158522,0.00668600175020978,0.0056442768382145,0.0047550876213392,0.00361913393803194,0.00218794919047284,0.00114178019765277,0.000590633730141234,0.000268414684811363,8.35161546379139e-05,1.52320011184313e-05,1.65049230671502e-06,1.48849045738758e-07,1.41086619903676e-08,1.05150708318334e-09,7.36002000975674e-11,4.62061980722657e-12,1.56179005930779e-13],[0.000164695248007628,0.000419109215896729,0.000781852466718564,0.00149399614759455,0.00277117636894741,0.00504909969443222,0.00799449347647854,0.00994915800030133,0.0102237251814344,0.00936521158859288,0.00819086059540012,0.00653389102869522,0.00438082395755761,0.00256482025299413,0.00149860112559463,0.000857843018505115,0.000353034526139715,8.7994385858981e-05,1.56695228726469e-05,2.64088690261489e-06,3.5907064222804e-07,4.06886210497744e-08,4.79219436751567e-09,3.64447480781066e-10,1.28576286555828e-11],[0.000163734395856942,0.000421449235046482,0.000787815909106694,0.00141274719103996,0.00263426866714312,0.00524355716751522,0.00882459025307898,0.0117381620265093,0.0131621313952342,0.0130636778141653,0.0120741436445235,0.0104598237268857,0.00812424146347652,0.00556043859114935,0.00361642857142264,0.00227019648568594,0.00110433599667666,0.000378497973796525,0.000107496298365604,2.54283984620084e-05,4.62947711442006e-06,8.97392711108625e-07,1.45343777701539e-07,1.19138170092644e-08,4.59258642118339e-10],[0.000105698042728928,0.00028472327733279,0.00058653021569802,0.00111652430323269,0.00209104071130724,0.00412908109420448,0.00717745112080265,0.0106467946082711,0.0134469627028029,0.0144406769021941,0.0144082760946084,0.0138106183938481,0.0120774989017395,0.00947073953462061,0.00698040310634433,0.0047840143100954,0.00266547110608762,0.00117089509206891,0.000431222862527625,0.000122630486279018,3.33767373621186e-05,1.0107554216934e-05,1.88044464918342e-06,1.67407019820231e-07,1.07313363541868e-08],[3.35917879074518e-05,0.000104471946287874,0.000284484583227917,0.00068758042777027,0.00144189297143841,0.00285349101678307,0.00521275098166967,0.00887482897712672,0.0125695997891398,0.0144832820336467,0.0158648145071123,0.0169437063097732,0.0161939884436551,0.013823110264595,0.0111226818484894,0.00808917966447274,0.00482656929787473,0.00242429356616441,0.00100392569341886,0.000335456761091181,0.000136346039319028,5.18188721367311e-05,1.06463381568742e-05,1.41350123198429e-06,2.9147425927652e-07],[4.86943486708112e-06,2.1851841832187e-05,9.77461592046792e-05,0.000345945877574711,0.000943961784043773,0.0020995260196014,0.00410147306196285,0.00741670227455732,0.0113166420973374,0.0144476646176569,0.0173405015414363,0.0197728644569728,0.0200728687669769,0.0180502087891812,0.0150563192753757,0.0111748442697816,0.0070010028522458,0.00386088254467724,0.00170891347080988,0.000647204204305829,0.000311519189688014,0.00012859136502462,3.68812633666579e-05,1.3007511349809e-05,5.37028026030551e-06],[3.75736310691724e-07,3.27752904980953e-06,2.47397035465481e-05,0.000130709002787979,0.000493114241782798,0.00135099236913248,0.00291215932770932,0.00543768642794668,0.00914757863658738,0.0135217856079256,0.0174342368657174,0.0202250577879243,0.0214652472835183,0.0206323472791175,0.0181329528582846,0.0141995824734955,0.00967263116943062,0.00569582566521872,0.00269050153811706,0.00115226137091431,0.000549276993952921,0.000249105329402732,0.000134404322582895,8.77430067036306e-05,4.3463259226413e-05],[2.21777065066045e-08,4.00056118202214e-07,5.32743414891302e-06,4.71281707030015e-05,0.000249271812256972,0.000788021384247752,0.00171389404314381,0.00329265417225719,0.00642385372394773,0.010950120081894,0.0147926433442889,0.0173481085132007,0.0195532270009159,0.0206702055864396,0.0197825504824914,0.0171021707784054,0.0130738898681633,0.00824257350150588,0.00427127153160665,0.00212821768386483,0.00106317262838741,0.000530904292991443,0.000360797280687722,0.000271473987306319,0.000143616190343555],[1.87501644262129e-09,8.78037371961113e-08,2.28308819047505e-06,2.86571373050481e-05,0.000171261250180513,0.000524531722969894,0.00102487820662003,0.00194007628283342,0.00412352887806835,0.00749759651156003,0.0104099802647696,0.0126947807869547,0.0156053342164982,0.0181937116261072,0.0190710528608872,0.0184529420190078,0.0159247736919704,0.011113481343508,0.0063944242414771,0.00344709387661223,0.00183057778246135,0.000946235717116305,0.000549407002331392,0.000369666327210076,0.000194537368677811],[5.07693394256865e-10,3.5834700074278e-08,1.14158100215058e-06,1.65814473771028e-05,0.000113034453372813,0.000386007912424376,0.000791589274697231,0.00140076594701756,0.00266044564697693,0.00467105649838188,0.00671082182971635,0.00875354209066886,0.0115263737149161,0.0145114439397501,0.0169013004173229,0.0181277436584727,0.0167803237809734,0.0126008922395469,0.00791396214055714,0.0046055284854342,0.00277345420232642,0.00158592108365667,0.000735200338358304,0.000312681213159186,0.000125412944814758],[1.22497764954968e-10,1.02650949425139e-08,3.94740126993429e-07,7.04753806195244e-06,5.93808355770679e-05,0.00024612593815486,0.000566664973701473,0.000951744550050911,0.0015958254863228,0.00276114501124644,0.00429321338434277,0.00593868399705315,0.00783621238573187,0.0105944561912246,0.0142373972712683,0.0166432394298943,0.0156812348194728,0.0120666422068287,0.00807688896501388,0.00520960487233541,0.00358690107009297,0.00229375755406125,0.00110382500578199,0.000399523625078348,0.000106805135122989],[1.93347130434717e-11,1.97227215961558e-09,9.22153300298317e-08,1.98550118151217e-06,1.98909781251555e-05,9.56823211259165e-05,0.00024502912473472,0.000438680623267004,0.000787323079655774,0.00149505833110908,0.0026712742471583,0.00398914963144027,0.00509964351584582,0.00718510483111149,0.0107007167230121,0.0132454251436394,0.0130341952567732,0.0107133602757255,0.00769044934493349,0.00512756553761777,0.00363195303362467,0.00250368870646697,0.00143600828760207,0.000665674399891047,0.000204965246030645],[1.912057496264e-12,2.27849996002806e-10,1.23515784392188e-08,3.05442332602582e-07,3.46431078414199e-06,1.85525498878934e-05,5.31158288145929e-05,0.000114939007332455,0.000261615747251441,0.00061826889618101,0.00141745735270904,0.00246545932750151,0.00325507591859467,0.00454824970684511,0.00669457932280118,0.00847427210105388,0.00914877434089516,0.0084984714305509,0.00656942749908512,0.00437385359133838,0.00319077267800438,0.00244252890873677,0.0016923657158858,0.000973552480660144,0.00037623245154863],[1.01309617355628e-13,1.36644370971991e-11,8.32750462337522e-10,2.28281860898409e-08,2.82083779996723e-07,1.63707456130071e-06,5.40602316465833e-06,1.58806833648559e-05,5.11131329704449e-05,0.00018056273793146,0.000585729333627918,0.00123788699743014,0.00181767894753618,0.00253141494134087,0.00352591043717523,0.00453562825411178,0.00545123534074509,0.00574989756343374,0.00478912360919753,0.00343448843217141,0.00296671357062352,0.0026669290256236,0.00203850173125768,0.00127175726254755,0.000627179019585995],[2.64391179687404e-15,3.9541130468617e-13,2.62883958512948e-11,7.7138893299159e-10,1.00711123737439e-08,6.30780920826172e-08,2.60459769781679e-07,1.17091404010268e-06,6.4223070519356e-06,3.97967694763019e-05,0.000174215228431157,0.000446258062984927,0.000814092354721191,0.00130921849945535,0.00179692553075494,0.00226454648764132,0.00301584866051295,0.00375738290644251,0.00357802995552679,0.00297445019445136,0.00294457288713906,0.00283089075172355,0.0021583243649575,0.00135174230237115,0.000771337061258896],[3.24366421611113e-17,5.21889830627297e-15,3.66261116001612e-13,1.11802269469686e-11,1.51925192276937e-10,1.06387026102579e-09,6.36499481194371e-09,5.37393801216153e-08,6.26938428398947e-07,5.9186361834799e-06,3.15424960479865e-05,0.000106252868653342,0.000290580117601996,0.000594097895044633,0.000792568935307815,0.000911488869476369,0.00138859630454462,0.00218731685646112,0.00253650669490231,0.00242392570421794,0.00236857341243181,0.00215261271339804,0.00156971878699431,0.000941578982141071,0.000523704456941824],[1.77496084760789e-19,2.98017455269471e-17,2.15353823268818e-15,6.72986252069613e-14,9.5841827714638e-13,8.31817709020049e-12,9.48277279362666e-11,2.00764576576656e-09,4.09553751219711e-08,4.73477066852972e-07,3.22738879543151e-06,1.7465084478523e-05,7.23946973540746e-05,0.00016994294290451,0.000214822946380703,0.000231181651212602,0.000452851452217872,0.000948924751016775,0.0013719530795912,0.00148943716287497,0.00136615553591948,0.00110112684027814,0.000788423484786217,0.000476015173205125,0.000222530974917274],[4.13217336909082e-22,7.09136854244541e-20,5.20370656667621e-18,1.65936657299091e-16,2.58572826409946e-15,3.61911681416909e-14,1.21396277913803e-12,5.29574797595419e-11,1.35383339281867e-09,1.92945613242329e-08,2.11667637450606e-07,1.90235019969928e-06,9.79540822053264e-06,2.39196104159438e-05,2.89239619691129e-05,3.35883313869489e-05,0.00010049590353559,0.000290540824228266,0.000547550731260621,0.000699049686457391,0.000616720905553448,0.000439462383578763,0.000362923140733237,0.000270104584704502,0.000113152087049296]],"colorscale":"YlGnBu","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"plot_bgcolor":"#DFE6EB","paper_bgcolor":"#DFE6EB","fig_bgcolor":"#DFE6EB","scene":{"camera":{"eye":{"x":0,"y":-1,"z":0.75},"center":{"x":0,"y":0,"z":-0.25}},"aspectratio":{"x":0.9,"y":0.8,"z":0.4},"xaxis":{"title":"Variable A"},"yaxis":{"title":"Variable B"},"zaxis":{"title":"Joint density"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":"YlGnBu","showscale":true,"x":[-0.0807095806719289,0.307916442595626,0.69654246586318,1.08516848913073,1.47379451239829,1.86242053566584,2.2510465589334,2.63967258220095,3.02829860546851,3.41692462873606,3.80555065200362,4.19417667527117,4.58280269853873,4.97142872180628,5.36005474507383,5.74868076834139,6.13730679160894,6.5259328148765,6.91455883814405,7.30318486141161,7.69181088467916,8.08043690794672,8.46906293121427,8.85768895448182,9.24631497774938],"y":[-3.30568873578819,-1.79530948768298,-0.284930239577762,1.22544900852745,2.73582825663267,4.24620750473788,5.7565867528431,7.26696600094831,8.77734524905353,10.2877244971587,11.798103745264,13.3084829933692,14.8188622414744,16.3292414895796,17.8396207376848,19.34999998579,20.8603792338952,22.3707584820005,23.8811377301057,25.3915169782109,26.9018962263161,28.4122754744213,29.9226547225265,31.4330339706318,32.943413218737],"z":[[0.00024508886410526,0.000167519136787181,7.23264479565564e-05,8.7790748227019e-05,0.000150997725375558,0.000145057695075036,9.33086576110266e-05,7.27038055999315e-05,5.89007062776598e-05,4.05050077072412e-05,2.03254513334412e-05,5.8175859371393e-06,9.62161967798373e-07,1.00138715757e-07,5.9047321191474e-09,1.66978438769237e-10,2.07912182555249e-12,1.11061078159493e-14,2.62688008037698e-17,4.21108910311574e-20,1.22275994895103e-22,2.99557108321877e-25,3.36498074091128e-28,1.63480594649313e-31,3.68029069171043e-35],[0.000190410558866371,0.000180769966980471,0.000169730037917858,0.000273290647847732,0.000425153163935444,0.00040179905960646,0.000293890135190469,0.000274346666737066,0.000240944593695991,0.000180748469593847,0.000102523178456552,3.7089468309811e-05,8.63883386991101e-06,1.17114843916792e-06,7.75852023639417e-08,2.28129983729178e-09,2.90193255183716e-11,1.74364445236043e-13,1.0132024417135e-15,9.88162929997035e-18,5.96240494831403e-20,1.59599285563772e-22,1.86490762513196e-25,1.03468995779599e-28,5.7335205694112e-32],[0.000181224135326733,0.000303372716416055,0.000400745385844619,0.000536235996145626,0.000681677337549412,0.000613676869725022,0.000491829972740464,0.000500209151714657,0.000444433674355811,0.000357268421874213,0.000251229939721038,0.000127959553539725,3.96005451822329e-05,6.13142050430614e-06,4.26875915763742e-07,1.31699768677606e-08,2.23003058960697e-10,5.09964757657508e-12,1.40563350966373e-13,2.02619820275674e-15,1.29348936095228e-17,3.67538915274733e-20,5.13840940171888e-23,6.86304609426317e-26,2.34241392076309e-28],[0.000225698174491013,0.000432569723507913,0.000643042298053052,0.000913275926088243,0.00113533247406491,0.000991090738817961,0.000702150094274123,0.000591419914263935,0.000470771664273875,0.000389692243468388,0.000358748393348194,0.00024119481142929,8.59257989334876e-05,1.43104009587808e-05,1.14626249200425e-06,6.53781160103376e-08,5.19988567903116e-09,3.50382055893124e-10,1.1824708937556e-11,1.80648394139002e-13,1.26990236409184e-15,4.60117523026591e-18,1.49116271513345e-20,9.91001181217751e-23,7.76507411368617e-25],[0.000150271307581504,0.00035064815848264,0.00073477812400342,0.00134026972969151,0.00183765430080911,0.00172973539719237,0.00127045372615812,0.00097102425296357,0.000716406026183231,0.000528865449746625,0.000454485572182241,0.000306394229123308,0.000119193545689801,2.77837237884181e-05,5.33272795104367e-06,1.05907533720786e-06,1.55192445734476e-07,1.19968992878276e-08,4.41142262610415e-10,7.85865025780023e-12,7.58856409719853e-14,5.96095624645547e-16,7.68679187838861e-18,1.09265062233149e-19,1.53606758845227e-21],[6.24119278458045e-05,0.000243053096183372,0.000762590282034262,0.00164814006513693,0.00242260012941292,0.00262283367237308,0.00250739309891553,0.00229981339092836,0.00181506147918392,0.00129208767202061,0.00095676971911064,0.000629774768070952,0.000317532452839975,0.000127584789555953,4.50138247631201e-05,1.2676627421307e-05,2.16602514531694e-06,1.92964916932064e-07,8.95062131770275e-09,2.34151019351187e-10,4.43667317668071e-12,1.0930849155116e-13,2.93116076767344e-15,6.99356275035407e-17,1.6168256192813e-18],[6.2626149361263e-05,0.000248121596339015,0.000778430450040387,0.00181255736075202,0.0029085085032159,0.00366813810757154,0.00434050157864386,0.00455395609434902,0.00387987994023496,0.00298336832540319,0.00237355416945188,0.00173028582598385,0.00100088165759343,0.000481560174887576,0.000212643352727932,7.34916098168515e-05,1.57612189425519e-05,1.93552905763632e-06,1.36342761413542e-07,6.20026428914048e-09,2.90065844144593e-10,1.48006873423392e-11,6.12151073007542e-13,2.55413007685167e-14,7.76317127314241e-16],[0.000121143279621856,0.000338251799187226,0.000760933741335707,0.00167268752404723,0.0029416523864437,0.00443713871599664,0.00617688655031233,0.00712671710158522,0.00668600175020978,0.0056442768382145,0.0047550876213392,0.00361913393803194,0.00218794919047284,0.00114178019765277,0.000590633730141234,0.000268414684811363,8.35161546379139e-05,1.52320011184313e-05,1.65049230671502e-06,1.48849045738758e-07,1.41086619903676e-08,1.05150708318334e-09,7.36002000975674e-11,4.62061980722657e-12,1.56179005930779e-13],[0.000164695248007628,0.000419109215896729,0.000781852466718564,0.00149399614759455,0.00277117636894741,0.00504909969443222,0.00799449347647854,0.00994915800030133,0.0102237251814344,0.00936521158859288,0.00819086059540012,0.00653389102869522,0.00438082395755761,0.00256482025299413,0.00149860112559463,0.000857843018505115,0.000353034526139715,8.7994385858981e-05,1.56695228726469e-05,2.64088690261489e-06,3.5907064222804e-07,4.06886210497744e-08,4.79219436751567e-09,3.64447480781066e-10,1.28576286555828e-11],[0.000163734395856942,0.000421449235046482,0.000787815909106694,0.00141274719103996,0.00263426866714312,0.00524355716751522,0.00882459025307898,0.0117381620265093,0.0131621313952342,0.0130636778141653,0.0120741436445235,0.0104598237268857,0.00812424146347652,0.00556043859114935,0.00361642857142264,0.00227019648568594,0.00110433599667666,0.000378497973796525,0.000107496298365604,2.54283984620084e-05,4.62947711442006e-06,8.97392711108625e-07,1.45343777701539e-07,1.19138170092644e-08,4.59258642118339e-10],[0.000105698042728928,0.00028472327733279,0.00058653021569802,0.00111652430323269,0.00209104071130724,0.00412908109420448,0.00717745112080265,0.0106467946082711,0.0134469627028029,0.0144406769021941,0.0144082760946084,0.0138106183938481,0.0120774989017395,0.00947073953462061,0.00698040310634433,0.0047840143100954,0.00266547110608762,0.00117089509206891,0.000431222862527625,0.000122630486279018,3.33767373621186e-05,1.0107554216934e-05,1.88044464918342e-06,1.67407019820231e-07,1.07313363541868e-08],[3.35917879074518e-05,0.000104471946287874,0.000284484583227917,0.00068758042777027,0.00144189297143841,0.00285349101678307,0.00521275098166967,0.00887482897712672,0.0125695997891398,0.0144832820336467,0.0158648145071123,0.0169437063097732,0.0161939884436551,0.013823110264595,0.0111226818484894,0.00808917966447274,0.00482656929787473,0.00242429356616441,0.00100392569341886,0.000335456761091181,0.000136346039319028,5.18188721367311e-05,1.06463381568742e-05,1.41350123198429e-06,2.9147425927652e-07],[4.86943486708112e-06,2.1851841832187e-05,9.77461592046792e-05,0.000345945877574711,0.000943961784043773,0.0020995260196014,0.00410147306196285,0.00741670227455732,0.0113166420973374,0.0144476646176569,0.0173405015414363,0.0197728644569728,0.0200728687669769,0.0180502087891812,0.0150563192753757,0.0111748442697816,0.0070010028522458,0.00386088254467724,0.00170891347080988,0.000647204204305829,0.000311519189688014,0.00012859136502462,3.68812633666579e-05,1.3007511349809e-05,5.37028026030551e-06],[3.75736310691724e-07,3.27752904980953e-06,2.47397035465481e-05,0.000130709002787979,0.000493114241782798,0.00135099236913248,0.00291215932770932,0.00543768642794668,0.00914757863658738,0.0135217856079256,0.0174342368657174,0.0202250577879243,0.0214652472835183,0.0206323472791175,0.0181329528582846,0.0141995824734955,0.00967263116943062,0.00569582566521872,0.00269050153811706,0.00115226137091431,0.000549276993952921,0.000249105329402732,0.000134404322582895,8.77430067036306e-05,4.3463259226413e-05],[2.21777065066045e-08,4.00056118202214e-07,5.32743414891302e-06,4.71281707030015e-05,0.000249271812256972,0.000788021384247752,0.00171389404314381,0.00329265417225719,0.00642385372394773,0.010950120081894,0.0147926433442889,0.0173481085132007,0.0195532270009159,0.0206702055864396,0.0197825504824914,0.0171021707784054,0.0130738898681633,0.00824257350150588,0.00427127153160665,0.00212821768386483,0.00106317262838741,0.000530904292991443,0.000360797280687722,0.000271473987306319,0.000143616190343555],[1.87501644262129e-09,8.78037371961113e-08,2.28308819047505e-06,2.86571373050481e-05,0.000171261250180513,0.000524531722969894,0.00102487820662003,0.00194007628283342,0.00412352887806835,0.00749759651156003,0.0104099802647696,0.0126947807869547,0.0156053342164982,0.0181937116261072,0.0190710528608872,0.0184529420190078,0.0159247736919704,0.011113481343508,0.0063944242414771,0.00344709387661223,0.00183057778246135,0.000946235717116305,0.000549407002331392,0.000369666327210076,0.000194537368677811],[5.07693394256865e-10,3.5834700074278e-08,1.14158100215058e-06,1.65814473771028e-05,0.000113034453372813,0.000386007912424376,0.000791589274697231,0.00140076594701756,0.00266044564697693,0.00467105649838188,0.00671082182971635,0.00875354209066886,0.0115263737149161,0.0145114439397501,0.0169013004173229,0.0181277436584727,0.0167803237809734,0.0126008922395469,0.00791396214055714,0.0046055284854342,0.00277345420232642,0.00158592108365667,0.000735200338358304,0.000312681213159186,0.000125412944814758],[1.22497764954968e-10,1.02650949425139e-08,3.94740126993429e-07,7.04753806195244e-06,5.93808355770679e-05,0.00024612593815486,0.000566664973701473,0.000951744550050911,0.0015958254863228,0.00276114501124644,0.00429321338434277,0.00593868399705315,0.00783621238573187,0.0105944561912246,0.0142373972712683,0.0166432394298943,0.0156812348194728,0.0120666422068287,0.00807688896501388,0.00520960487233541,0.00358690107009297,0.00229375755406125,0.00110382500578199,0.000399523625078348,0.000106805135122989],[1.93347130434717e-11,1.97227215961558e-09,9.22153300298317e-08,1.98550118151217e-06,1.98909781251555e-05,9.56823211259165e-05,0.00024502912473472,0.000438680623267004,0.000787323079655774,0.00149505833110908,0.0026712742471583,0.00398914963144027,0.00509964351584582,0.00718510483111149,0.0107007167230121,0.0132454251436394,0.0130341952567732,0.0107133602757255,0.00769044934493349,0.00512756553761777,0.00363195303362467,0.00250368870646697,0.00143600828760207,0.000665674399891047,0.000204965246030645],[1.912057496264e-12,2.27849996002806e-10,1.23515784392188e-08,3.05442332602582e-07,3.46431078414199e-06,1.85525498878934e-05,5.31158288145929e-05,0.000114939007332455,0.000261615747251441,0.00061826889618101,0.00141745735270904,0.00246545932750151,0.00325507591859467,0.00454824970684511,0.00669457932280118,0.00847427210105388,0.00914877434089516,0.0084984714305509,0.00656942749908512,0.00437385359133838,0.00319077267800438,0.00244252890873677,0.0016923657158858,0.000973552480660144,0.00037623245154863],[1.01309617355628e-13,1.36644370971991e-11,8.32750462337522e-10,2.28281860898409e-08,2.82083779996723e-07,1.63707456130071e-06,5.40602316465833e-06,1.58806833648559e-05,5.11131329704449e-05,0.00018056273793146,0.000585729333627918,0.00123788699743014,0.00181767894753618,0.00253141494134087,0.00352591043717523,0.00453562825411178,0.00545123534074509,0.00574989756343374,0.00478912360919753,0.00343448843217141,0.00296671357062352,0.0026669290256236,0.00203850173125768,0.00127175726254755,0.000627179019585995],[2.64391179687404e-15,3.9541130468617e-13,2.62883958512948e-11,7.7138893299159e-10,1.00711123737439e-08,6.30780920826172e-08,2.60459769781679e-07,1.17091404010268e-06,6.4223070519356e-06,3.97967694763019e-05,0.000174215228431157,0.000446258062984927,0.000814092354721191,0.00130921849945535,0.00179692553075494,0.00226454648764132,0.00301584866051295,0.00375738290644251,0.00357802995552679,0.00297445019445136,0.00294457288713906,0.00283089075172355,0.0021583243649575,0.00135174230237115,0.000771337061258896],[3.24366421611113e-17,5.21889830627297e-15,3.66261116001612e-13,1.11802269469686e-11,1.51925192276937e-10,1.06387026102579e-09,6.36499481194371e-09,5.37393801216153e-08,6.26938428398947e-07,5.9186361834799e-06,3.15424960479865e-05,0.000106252868653342,0.000290580117601996,0.000594097895044633,0.000792568935307815,0.000911488869476369,0.00138859630454462,0.00218731685646112,0.00253650669490231,0.00242392570421794,0.00236857341243181,0.00215261271339804,0.00156971878699431,0.000941578982141071,0.000523704456941824],[1.77496084760789e-19,2.98017455269471e-17,2.15353823268818e-15,6.72986252069613e-14,9.5841827714638e-13,8.31817709020049e-12,9.48277279362666e-11,2.00764576576656e-09,4.09553751219711e-08,4.73477066852972e-07,3.22738879543151e-06,1.7465084478523e-05,7.23946973540746e-05,0.00016994294290451,0.000214822946380703,0.000231181651212602,0.000452851452217872,0.000948924751016775,0.0013719530795912,0.00148943716287497,0.00136615553591948,0.00110112684027814,0.000788423484786217,0.000476015173205125,0.000222530974917274],[4.13217336909082e-22,7.09136854244541e-20,5.20370656667621e-18,1.65936657299091e-16,2.58572826409946e-15,3.61911681416909e-14,1.21396277913803e-12,5.29574797595419e-11,1.35383339281867e-09,1.92945613242329e-08,2.11667637450606e-07,1.90235019969928e-06,9.79540822053264e-06,2.39196104159438e-05,2.89239619691129e-05,3.35883313869489e-05,0.00010049590353559,0.000290540824228266,0.000547550731260621,0.000699049686457391,0.000616720905553448,0.000439462383578763,0.000362923140733237,0.000270104584704502,0.000113152087049296]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
]


---

### 4. Wrap up!

#### 1. Joint distribution

&lt;center&gt;&lt;h4&gt;  &amp;#10140; &lt;i&gt; When describing a joint distribution, we're interested in the relationship between the two variables &lt;/i&gt;&lt;/h4&gt;&lt;/center&gt;

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

--

&lt;ul&gt;
  &lt;li&gt;The &lt;b&gt;covariance&lt;/b&gt; quantifies the joint deviation of two variables from their respective mean&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;It can take values from \(-\infty\) to \(\infty\) and depends on the unit of the data&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
 
$$ \text{Cov}(x, y) = \frac{1}{N}\sum_{i=1}^{N}(x_i − \bar{x})(y_i − \bar{y})$$

&lt;p style = "margin-bottom:1.5cm;"&gt;&lt;/p&gt;

--


&lt;ul&gt;
  &lt;li&gt;The &lt;b&gt;correlation&lt;/b&gt; is the covariance of two variables divided by the product of their standard deviation&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;It can take values from \(-1\) to \(1\) and is independent from the unit of the data&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;
 
 `$$\text{Corr}(x, y) = \frac{\text{Cov}(x, y)}{\text{SD}(x)\times\text{SD}(y)}$$`
 
---

### 4. Wrap up!

#### 2. Regression

.pull-left[
&lt;p style = "margin-bottom:-.75cm;"&gt;&lt;/p&gt;
&lt;img src="slides_files/figure-html/unnamed-chunk-68-1.png" width="100%" style="display: block; margin: auto;" /&gt;
&lt;p style = "margin-bottom:-1.2cm;"&gt;&lt;/p&gt;

```
## 
## Call:
## lm(formula = y ~ x, data = data)
## 
## Coefficients:
## (Intercept)            x  
##    -0.09129      1.01546
```
]

--

.pull-right[

 * This can be expressed with the **regression equation:**
 
`$$y_i = \hat{\alpha} + \hat{\beta}x_i + \hat{\varepsilon_i}$$`


 * Where `\(\hat{\alpha}\)` is the **intercept** and `\(\hat{\beta}\)` the **slope** of the **line** `\(\hat{y_i} = \hat{\alpha} + \hat{\beta}x_i\)`, and `\(\hat{\varepsilon_i}\)` the **distances** between the points and the line

&lt;p style = "margin-bottom:1cm;"&gt;

`$$\hat{\beta} = \frac{\text{Cov}(x_i, y_i)}{\text{Var}(x_i)}$$` 

`$$\hat{\alpha} = \bar{y} - \hat{\beta} \times\bar{x}$$`

* `\(\hat{\alpha}\)` and `\(\hat{\beta}\)` minimize `\(\hat{\varepsilon_i}\)`

]

---

### 4. Wrap up!

#### 3. Binary variables

.pull-left[
&lt;center&gt;Binary &lt;b&gt;dependent&lt;/b&gt; variables&lt;/center&gt;

&lt;ul&gt;
  &lt;li&gt;The &lt;b&gt;fitted values&lt;/b&gt; can be viewed as &lt;b&gt;probabilities&lt;/b&gt;&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;\(\hat{\beta}\) is the expected increase in the probability that \(y = 1\) for a one unit increase in \(x\)&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;p style = "margin-bottom:1cm;"&gt;

&lt;img src="slides_files/figure-html/unnamed-chunk-70-1.png" width="100%" style="display: block; margin: auto;" /&gt;

&lt;p style = "margin-bottom:1cm;"&gt;

&lt;ul&gt;
  &lt;ul&gt;
    &lt;li&gt;We call that a &lt;b&gt;Linear Probability model&lt;/b&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

]

--

.pull-right[
&lt;center&gt;Binary &lt;b&gt;independent&lt;/b&gt; variables&lt;/center&gt;

&lt;ul&gt;
  &lt;li&gt;The \(x\) variable should be viewed as a &lt;b&gt;dummy 0/1&lt;/b&gt;&lt;/li&gt;
  &lt;ul&gt;
    &lt;li&gt;\(\hat{\beta}\) is the difference between the average \(y\) for the group \(x = 1\) and the group \(x = 0\)&lt;/li&gt;
  &lt;/ul&gt;
&lt;/ul&gt;

&lt;img src="slides_files/figure-html/unnamed-chunk-71-1.png" width="90%" style="display: block; margin: auto;" /&gt;
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  top: 1em;
  right: 1em;
  z-index: 0;
 width: 10px;
  height: 10px;
  background: #DFE6EB;
  border-radius: 80px;
  text-align:left;
  padding:24px;
  box-shadow: 4px 4px 6px #c7c4c4, 
              -4px -4px 6px #E7EDF0;
}
.logo:active {
  box-shadow: inset 4px 4px 6px #c7c4c4, 
              inset -4px -4px 6px #E7EDF0
}

</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // add additional classes to exclude here, e.g.
    // ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"><a href = "https://louissirugue.github.io/metrics_on_R/home.html"><p style = "margin-left:-.55cm;margin-top:-.55cm;width:53px"> <img src = "../source/home2.png"> </p> </a></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
